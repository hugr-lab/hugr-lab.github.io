"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[3439],{1333:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"engine-configuration/schema-definition/modules","title":"Module Organization","description":"Modules in Hugr provide a way to organize and namespace your data objects, functions, and operations within the GraphQL schema. By using modules, you can create a hierarchical structure that helps avoid naming conflicts and improves the clarity of your API.","source":"@site/docs/4-engine-configuration/3-schema-definition/4-modules.md","sourceDirName":"4-engine-configuration/3-schema-definition","slug":"/engine-configuration/schema-definition/modules","permalink":"/docs/engine-configuration/schema-definition/modules","draft":false,"unlisted":false,"editUrl":"https://github.com/hugr-lab/hugr-lab.github.io/docs/4-engine-configuration/3-schema-definition/4-modules.md","tags":[],"version":"current","lastUpdatedBy":"Claude","lastUpdatedAt":1762532849000,"sidebarPosition":10,"frontMatter":{"title":"Module Organization","sidebar_position":10},"sidebar":"docsSidebar","previous":{"title":"Field Transformations and Additional Fields","permalink":"/docs/engine-configuration/schema-definition/data-objects/field-transformations"},"next":{"title":"Extensions & Cross-Source Subqueries","permalink":"/docs/engine-configuration/extension"}}');var o=s(4848),t=s(8453);const r={title:"Module Organization",sidebar_position:10},a="Module Organization",l={},d=[{value:"Defining Modules",id:"defining-modules",level:2},{value:"Nested Modules",id:"nested-modules",level:3},{value:"Generated GraphQL Types",id:"generated-graphql-types",level:2},{value:"Type Naming Convention",id:"type-naming-convention",level:3},{value:"Usage in Access Control",id:"usage-in-access-control",level:3},{value:"Querying with Modules",id:"querying-with-modules",level:2},{value:"Mutations with Modules",id:"mutations-with-modules",level:2},{value:"Functions in Modules",id:"functions-in-modules",level:2},{value:"Data Sources as Modules",id:"data-sources-as-modules",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"module-organization",children:"Module Organization"})}),"\n",(0,o.jsx)(n.p,{children:"Modules in Hugr provide a way to organize and namespace your data objects, functions, and operations within the GraphQL schema. By using modules, you can create a hierarchical structure that helps avoid naming conflicts and improves the clarity of your API."}),"\n",(0,o.jsx)(n.h2,{id:"defining-modules",children:"Defining Modules"}),"\n",(0,o.jsxs)(n.p,{children:["Modules are defined using the ",(0,o.jsx)(n.code,{children:"@module"})," directive on types, views, or functions. You can specify a module name to group related objects together."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-graphql",children:'type customers @table(name: "customers") @module(name: "crm") {\n  id: Int! @pk\n  name: String!\n  email: String!\n  created_at: Timestamp\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["In this example, the ",(0,o.jsx)(n.code,{children:"customers"})," table is placed in the ",(0,o.jsx)(n.code,{children:"crm"})," module.  This means that all operations related to customers will be namespaced under the ",(0,o.jsx)(n.code,{children:"crm"})," module, helping to avoid naming conflicts with other parts of the schema."]}),"\n",(0,o.jsx)(n.h3,{id:"nested-modules",children:"Nested Modules"}),"\n",(0,o.jsxs)(n.p,{children:["Modules can be nested to create a more complex hierarchy. For example, you might have a ",(0,o.jsx)(n.code,{children:"sales"})," module that contains a ",(0,o.jsx)(n.code,{children:"reports"})," submodule:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-graphql",children:'type total_sales @view(name: "total_sales_view") @module(name: "sales.reports") {\n  category: String\n  year: Int\n  total: Float\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"This structure allows you to organize your schema in a way that reflects the logical grouping of your data and operations."}),"\n",(0,o.jsx)(n.h2,{id:"generated-graphql-types",children:"Generated GraphQL Types"}),"\n",(0,o.jsx)(n.p,{children:"When you define modules in your schema, Hugr automatically generates separate GraphQL types for queries, mutations, and functions within each module. Understanding these type names is important when configuring access control and permissions."}),"\n",(0,o.jsx)(n.h3,{id:"type-naming-convention",children:"Type Naming Convention"}),"\n",(0,o.jsx)(n.p,{children:"For each module, Hugr creates the following GraphQL types:"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsxs)(n.strong,{children:["For the default module (no ",(0,o.jsx)(n.code,{children:"@module"})," directive):"]})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Query type"}),": ",(0,o.jsx)(n.code,{children:'"Query"'})," - Contains all query fields (tables, views, aggregations)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Mutation type"}),": ",(0,o.jsx)(n.code,{children:'"Mutation"'})," - Contains all mutation fields (insert_, update_, delete_)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Function type"}),": ",(0,o.jsx)(n.code,{children:'"Function"'})," - Contains all read-only function fields"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"MutationFunction type"}),": ",(0,o.jsx)(n.code,{children:'"MutationFunction"'})," - Contains all mutating function fields"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"For named modules:"})}),"\n",(0,o.jsxs)(n.p,{children:["The type name follows the pattern: ",(0,o.jsx)(n.code,{children:"_module_<module_name>_<suffix>"})]}),"\n",(0,o.jsx)(n.p,{children:"Where suffix is:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"_query"})," for query types"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"_mutation"})," for mutation types"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"_function"})," for function types"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"_function_mutation"})," for mutating function types"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Module ",(0,o.jsx)(n.code,{children:"crm"})," \u2192 Query type: ",(0,o.jsx)(n.code,{children:'"_module_crm_query"'})]}),"\n",(0,o.jsxs)(n.li,{children:["Module ",(0,o.jsx)(n.code,{children:"crm"})," \u2192 Mutation type: ",(0,o.jsx)(n.code,{children:'"_module_crm_mutation"'})]}),"\n",(0,o.jsxs)(n.li,{children:["Module ",(0,o.jsx)(n.code,{children:"crm"})," \u2192 Function type: ",(0,o.jsx)(n.code,{children:'"_module_crm_function"'})]}),"\n",(0,o.jsxs)(n.li,{children:["Module ",(0,o.jsx)(n.code,{children:"core"})," \u2192 Query type: ",(0,o.jsx)(n.code,{children:'"_module_core_query"'})]}),"\n",(0,o.jsxs)(n.li,{children:["Module ",(0,o.jsx)(n.code,{children:"core"})," \u2192 Mutation type: ",(0,o.jsx)(n.code,{children:'"_module_core_mutation"'})]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"For nested modules:"})}),"\n",(0,o.jsx)(n.p,{children:"Dots in module names are replaced with underscores:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Module ",(0,o.jsx)(n.code,{children:"sales.reports"})," \u2192 Query type: ",(0,o.jsx)(n.code,{children:'"_module_sales_reports_query"'})]}),"\n",(0,o.jsxs)(n.li,{children:["Module ",(0,o.jsx)(n.code,{children:"sales.reports"})," \u2192 Mutation type: ",(0,o.jsx)(n.code,{children:'"_module_sales_reports_mutation"'})]}),"\n",(0,o.jsxs)(n.li,{children:["Module ",(0,o.jsx)(n.code,{children:"data.analytics.metrics"})," \u2192 Query type: ",(0,o.jsx)(n.code,{children:'"_module_data_analytics_metrics_query"'})]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"usage-in-access-control",children:"Usage in Access Control"}),"\n",(0,o.jsxs)(n.p,{children:["These type names are used when configuring role-based access control (RBAC) permissions. The ",(0,o.jsx)(n.code,{children:"type_name"})," field in permissions refers to these generated GraphQL types:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-graphql",children:'mutation {\n  core {\n    # Restrict access to all queries in the crm module\n    insert_role_permissions(data: {\n      role: "external_api"\n      type_name: "_module_crm_query"     # Query type for crm module\n      field_name: "*"                     # All query fields\n      disabled: true\n    }) {\n      role\n      type_name\n    }\n  }\n}\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-graphql",children:'mutation {\n  core {\n    # Allow only specific mutation in sales.reports module\n    insert_role_permissions(data: {\n      role: "analyst"\n      type_name: "_module_sales_reports_mutation"  # Mutation type for sales.reports module\n      field_name: "insert_report_data"             # Specific mutation field\n      disabled: false\n    }) {\n      role\n      type_name\n    }\n  }\n}\n'})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-graphql",children:'mutation {\n  core {\n    # Block all mutations in default module\n    insert_role_permissions(data: {\n      role: "readonly"\n      type_name: "Mutation"               # Default module Mutation type\n      field_name: "*"                     # All mutation fields\n      disabled: true\n    }) {\n      role\n      type_name\n    }\n  }\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["See ",(0,o.jsx)(n.a,{href:"/docs/engine-configuration/access-control",children:"Access Control"})," for complete documentation on configuring permissions with module types."]}),"\n",(0,o.jsx)(n.h2,{id:"querying-with-modules",children:"Querying with Modules"}),"\n",(0,o.jsxs)(n.p,{children:["When querying data that is organized into modules, you will need to include the module names in your queries. For example, to query the ",(0,o.jsx)(n.code,{children:"customers"})," table in the ",(0,o.jsx)(n.code,{children:"crm"})," module, you would write:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-graphql",children:"query {\n  crm {\n    customers {\n      id\n      name\n      email\n      created_at\n    }\n  }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Similarly, to query the ",(0,o.jsx)(n.code,{children:"total_sales"})," view in the ",(0,o.jsx)(n.code,{children:"sales.reports"})," module, you would write:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-graphql",children:"query {\n  sales {\n    reports {\n      total_sales {\n        category\n        year\n        total\n      }\n    }\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"mutations-with-modules",children:"Mutations with Modules"}),"\n",(0,o.jsxs)(n.p,{children:["Mutations are also namespaced according to their modules. For example, to insert a new customer in the ",(0,o.jsx)(n.code,{children:"crm"})," module, you would write:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-graphql",children:'mutation {\n  crm {\n    insert_customers(data: { name: "John Doe", email: "john.doe@example.com" }) {\n      id\n      name\n      email\n    }\n  }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"This structure helps to keep your mutations organized and prevents naming conflicts with other parts of the schema."}),"\n",(0,o.jsx)(n.h2,{id:"functions-in-modules",children:"Functions in Modules"}),"\n",(0,o.jsxs)(n.p,{children:["Functions can also be organized into modules. When defining a function, you can use the ",(0,o.jsx)(n.code,{children:"@module"})," directive to specify its module:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-graphql",children:'\nextend type Function {\n  get_customer_orders(customer_id: Int!): [order]\n    @function(name: "get_customer_orders")\n    @module(name: "crm")\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["This function can then be queried within the ",(0,o.jsx)(n.code,{children:"crm"})," module:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-graphql",children:"query {\n  function {\n    crm {\n      get_customer_orders(customer_id: 1) {\n        id\n        total\n      }\n    }\n  }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["For example module ",(0,o.jsx)(n.code,{children:"weather"})," for the function ",(0,o.jsx)(n.code,{children:"current_weather"})," - the generated function query will be accessible under the ",(0,o.jsx)(n.code,{children:"function.weather"})," namespace:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-graphql",children:"query {\n  function {\n    weather {\n      current_weather(lat: 40.7128, lon: -74.0060) {\n        id\n        name\n        main {\n          temp\n          pressure\n          humidity\n        }\n      }\n    }\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"data-sources-as-modules",children:"Data Sources as Modules"}),"\n",(0,o.jsxs)(n.p,{children:["When connecting to multiple data sources, each data source can be treated as a top-level module. This means that all tables, views, and functions from a specific data source will be grouped under its corresponding module. For example, if you have a data source named ",(0,o.jsx)(n.code,{children:"sales"})," that is marked ",(0,o.jsx)(n.code,{children:"as_module: true"}),", all related objects will be accessible under the ",(0,o.jsx)(n.code,{children:"sales"})," module:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-graphql",children:"query {\n  sales {\n    crm {\n      customers { ... }\n      customers_by_pk(id: 1) { ... }\n      customers_aggregation { ... }\n      customers_bucket_aggregation { ... }\n    }\n  }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["In this case, ",(0,o.jsx)(n.code,{children:"sales"})," is the top-level module representing the data source, and ",(0,o.jsx)(n.code,{children:"crm"})," is a submodule containing the ",(0,o.jsx)(n.code,{children:"customers"})," table and its related operations."]}),"\n",(0,o.jsxs)(n.p,{children:["You can also define data source as a nested module, for example ",(0,o.jsx)(n.code,{children:"data_source_name.module_name"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-graphql",children:"query {\n  data_source_name {\n    module_name {\n      customers { ... }\n      customers_by_pk(id: 1) { ... }\n      customers_aggregation { ... }\n      customers_bucket_aggregation { ... }\n    }\n  }\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"This structure allows for clear organization and easy access to data from multiple sources within a single GraphQL schema."})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>a});var i=s(6540);const o={},t=i.createContext(o);function r(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);