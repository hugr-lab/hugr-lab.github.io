"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[4231],{8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>o});var a=s(6540);const t={},r=a.createContext(t);function i(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(r.Provider,{value:n},e.children)}},9833:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"engine-configuration/data-sources/index","title":"Overview","description":"Overview of the data sources supported by the `hugr` query engine and how to configure them.","source":"@site/docs/4-engine-configuration/1-data-sources/index.md","sourceDirName":"4-engine-configuration/1-data-sources","slug":"/engine-configuration/data-sources/","permalink":"/docs/engine-configuration/data-sources/","draft":false,"unlisted":false,"editUrl":"https://github.com/hugr-lab/hugr-lab.github.io/docs/4-engine-configuration/1-data-sources/index.md","tags":[],"version":"current","lastUpdatedBy":"vgsml","lastUpdatedAt":1749506002000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Overview","description":"Overview of the data sources supported by the `hugr` query engine and how to configure them."},"sidebar":"docsSidebar","previous":{"title":"Data Sources","permalink":"/docs/category/data-sources"},"next":{"title":"DuckDB","permalink":"/docs/engine-configuration/data-sources/duckdb"}}');var t=s(4848),r=s(8453);const i={sidebar_position:1,title:"Overview",description:"Overview of the data sources supported by the `hugr` query engine and how to configure them."},o=void 0,d={},c=[{value:"Supported Data Sources",id:"supported-data-sources",level:2},{value:"Configuration",id:"configuration",level:2},{value:"System tables",id:"system-tables",level:3},{value:"Data Sources Table",id:"data-sources-table",level:4},{value:"Catalog sources Table",id:"catalog-sources-table",level:4},{value:"System functions",id:"system-functions",level:3},{value:"Example Configuration",id:"example-configuration",level:2},{value:"Self-Describing Data Sources",id:"self-describing-data-sources",level:2},{value:"Rational databases",id:"rational-databases",level:2},{value:"Service data sources",id:"service-data-sources",level:2}];function l(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"hugr"})," query engine supports multiple data sources, allowing you to connect to various databases and data stores. Each data source can be configured with its own connection settings and schema definitions (catalogs).\nThis flexibility enables you to work with different types of data and integrate them into your applications seamlessly."]}),"\n",(0,t.jsx)(n.h2,{id:"supported-data-sources",children:"Supported Data Sources"}),"\n",(0,t.jsxs)(n.p,{children:["The following data sources are supported by the ",(0,t.jsx)(n.code,{children:"hugr"})," query engine:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"DuckDB"}),": A lightweight, embedded database engine (see ",(0,t.jsx)(n.a,{href:"/docs/engine-configuration/data-sources/duckdb",children:"DuckDB data source documentation"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"PostgreSQL"}),": A powerful, open-source relational database system (see ",(0,t.jsx)(n.a,{href:"/docs/engine-configuration/data-sources/postgres",children:"PostgreSQL data source documentation"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"MySQL"}),": A widely used open-source relational database management system (see ",(0,t.jsx)(n.a,{href:"/docs/engine-configuration/data-sources/mysql",children:"MySQL data source documentation"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"DuckLake"}),": A data lake solution that supports various storage systems, including cloud storage and distributed file systems. DuckLake is designed to handle large volumes of data and provides efficient querying capabilities and able to manage data and schema changes through snapshots (in development)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"HTTP RESTFul API"}),": Allows you to connect to any RESTful API endpoint."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Extension"}),": A special data source types that allows you to extend GraphQL data objects (tables and views) to add extra subquery (joins) and function calls fields. This is useful for creating custom logic or aggregations using data from other sources. The extension data source can also defines cross-data source views, which allow you to combine data from multiple data sources into a single view. This is useful for creating complex queries that span multiple data sources."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The file views (spatial formats, CSV, parquet, etc.) are supported through the DuckDB data source, which can read and write various file formats and locations directly."}),"\n",(0,t.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"system-tables",children:"System tables"}),"\n",(0,t.jsx)(n.p,{children:"Data sources can be configured by unified GraphQL API. This allows for a consistent and streamlined approach to managing data sources across different environments and use cases.\nThe following system tables are available for managing data sources:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"data_sources"}),": Contains information about all configured data sources."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"catalog_sources"}),": Contains information about the one or more schema definitions (catalogs)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"catalogs"}),": Contains information about the assigned catalogs to the data sources."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"data-sources-table",children:"Data Sources Table"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"data_sources"})," table contains the following fields:"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"name"})}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:"Unique name of the data source."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"type"})}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsxs)(n.td,{children:["Type of the data source (e.g., ",(0,t.jsx)(n.code,{children:"postgres"}),", ",(0,t.jsx)(n.code,{children:"mysql"}),", etc.)."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"prefix"})}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:"Prefix for the data source schema types and queries to avoid naming conflicts."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"description"})}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:"Description of the data source."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"as_module"})}),(0,t.jsx)(n.td,{children:"Boolean"}),(0,t.jsx)(n.td,{children:"Indicates if the data source should be attached to the GraphQL schema as a module."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"disabled"})}),(0,t.jsx)(n.td,{children:"Boolean"}),(0,t.jsx)(n.td,{children:"Indicates if the data source is disabled, and shouldn't be loaded at startup."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"path"})}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:"Connection string or path, it depends on data source type."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"read_only"})}),(0,t.jsx)(n.td,{children:"Boolean"}),(0,t.jsx)(n.td,{children:"Indicates if the data source is read-only, it would not allow to generate GraphQL mutations."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"self_defined"})}),(0,t.jsx)(n.td,{children:"Boolean"}),(0,t.jsx)(n.td,{children:"Indicates if the data source is self-defined, some of the data source types may return their schema definition with out needs to make catalogs."})]})]})]}),"\n",(0,t.jsxs)(n.p,{children:["The path can contain environment variables, which will be resolved at runtime. This allows for flexible configuration without hardcoding sensitive information like passwords. The name of the environment variable should be passed in the format ",(0,t.jsx)(n.code,{children:"[$ENV_VAR_NAME]"}),"."]}),"\n",(0,t.jsx)(n.h4,{id:"catalog-sources-table",children:"Catalog sources Table"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"catalog_sources"})," table contains the following fields:"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Field"}),(0,t.jsx)(n.th,{children:"Type"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"name"})}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:"Unique name of the catalog."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"type"})}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsxs)(n.td,{children:["Type of the catalog (e.g., ",(0,t.jsx)(n.code,{children:"uri"}),", ",(0,t.jsx)(n.code,{children:"localFS"}),", etc.)."]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"description"})}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:"Description of the catalog."})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"path"})}),(0,t.jsx)(n.td,{children:"String"}),(0,t.jsx)(n.td,{children:"Path to the catalog file or URI."})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"system-functions",children:"System functions"}),"\n",(0,t.jsxs)(n.p,{children:["To manually load/reload or unload the data sources you can use the ",(0,t.jsx)(n.code,{children:"load_data_sources"})," and ",(0,t.jsx)(n.code,{children:"unload_data_sources"})," mutation function. These mutations allow you to dynamically manage the data sources without needing to restart the engine."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'mutation loadDataSources {\n  core {\n    load_data_sources(name: "northwind") {\n      success\n      message\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'mutation unloadDataSources {\n  core {\n    unload_data_sources(name: "northwind") {\n      success\n      message\n    }\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["All GraphQL queries and mutations to manage data sources are available in the module ",(0,t.jsx)(n.code,{children:"core"})," in the root query and mutation types."]}),"\n",(0,t.jsxs)(n.p,{children:["In clustered environments, to load/reload or unload data sources, you can use the ",(0,t.jsx)(n.code,{children:"load_data_sources"})," and ",(0,t.jsx)(n.code,{children:"unload_data_sources"})," mutations in ",(0,t.jsx)(n.code,{children:"core.cluster"})," module. These mutations ensure that the data sources are synchronized across all nodes in the cluster."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'mutation loadDataSources {\n  core {\n    cluster{\n      load_data_sources(name: "northwind") {\n        success\n        message\n      }\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'mutation unloadDataSources {\n  core {\n    cluster {\n      unload_data_sources(name: "northwind") {\n        success\n        message\n      }\n    }\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["You can get the list of all data sources by querying the ",(0,t.jsx)(n.code,{children:"data_sources"})," table:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query getDataSources {\n  core {\n    data_sources {\n      name\n      description\n      as_module\n      disabled\n      path\n      prefix\n      read_only\n      self_defined\n      type\n      catalogs {\n        name\n        description\n        path\n        type\n      }\n    }\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"example-configuration",children:"Example Configuration"}),"\n",(0,t.jsx)(n.p,{children:"Here is an example of how to configure a PostgreSQL data source:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"mutation addNorthwindDataSet($data: data_sources_mut_input_data! = {}) {\n  core {\n    insert_data_sources(data: $data) {\n      name\n      description\n      as_module\n      disabled\n      path\n      prefix\n      read_only\n      self_defined\n      type\n      catalogs {\n        name\n        description\n        path\n        type\n      }\n    }\n  }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Variables:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "name": "northwind",\n    "type": "postgres",\n    "prefix": "nw",\n    "description": "The Northwind database example",\n    "read_only": false,\n    "as_module": true,\n    "path": "postgres://hugr:hugr_password@postgres:5432/northwind",\n    "catalogs": [\n      {\n        "name": "northwind",\n        "type": "uri",\n        "description": "Northwind database schema",\n        "path": "/workspace/get-started/schema"\n      }\n    ]\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["To learn how to mutation works go to the ",(0,t.jsx)(n.a,{href:"/docs/graphql/mutations",children:"GraphQL Operations - Mutations"})," section."]}),"\n",(0,t.jsx)(n.h2,{id:"self-describing-data-sources",children:"Self-Describing Data Sources"}),"\n",(0,t.jsxs)(n.p,{children:["The data sources can be marked as self-describing (",(0,t.jsx)(n.code,{children:"self_defined: true"}),"), which means that the data source will provide its own schema definition. This is useful for data sources that can generate their schema dynamically or have a predefined schema that does not require external catalogs."]}),"\n",(0,t.jsx)(n.p,{children:"When a data source is self-defined, it will automatically generate the GraphQL schema. All rational data sources (DuckDB, PostgreSQL, MySQL) support self-defined schema generation based on the metadata of the database objects (tables and views), you can use the following query to retrieve the schema:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'query schema{\n  function{\n    core{\n      describe_data_source_schema(name: "pg", self: true, log: true)\n    }\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The argument ",(0,t.jsx)(n.code,{children:"self: true"})," indicates that the schema should be generated based on the data source metadata, if it is not set, the schema will generate based on linked catalogs and self-defined flag. The ",(0,t.jsx)(n.code,{children:"log: true"})," argument will log the generated schema to the stdout, it can be useful for debugging purposes."]}),"\n",(0,t.jsx)(n.h2,{id:"rational-databases",children:"Rational databases"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"hugr"})," uses the rational database data sources (DuckDB, PostgreSQL, MySQL, DuckLake) as attached databases to the DuckDB query engine. You can explore the internal data sources structure (tables, views, constraints) by using metadata queries by views in core.meta module."]}),"\n",(0,t.jsx)(n.p,{children:"For example, this query is used to define the schema for the self-defined data sources:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'query dbMeta($name: String!) {\n  core {\n    meta {\n      databases_by_name(name: $name) {\n        name\n        description: comment\n        type\n        schemas(filter:{\n          _or:[\n            {internal: {eq: false}}\n            {name: {eq: "public"}}\n            {name: {eq: "main"}}\n          ]\n          _not: {\n                  _or:[\n              {name: {like: "_timescaledb%"}}\n              {name: {eq: "timescaledb_experimental"}}\n              {name: {eq: "timescaledb_information"}}\n            ]\n          }\n        }){\n          name\n          description: comment\n          tables(filter:{internal: {eq: false}}){\n            name\n            description: comment\n            schema_name: schema_name\n            columns(filter: {internal: {eq: false}}){\n              name\n              description: comment\n              data_type\n              default\n              is_nullable\n            }\n            constraints(filter:{\n              database_name: {eq: $name}\n            }){\n              name\n              type\n              references_schema_name: schema_name\n              references_table_name\n              columns\n              references_columns\n            }\n          }\n          views(filter:{internal: {eq: false}}){\n            name\n            description: comment\n            schema_name: schema_name\n            columns(filter: {internal: {eq: false}}){\n              name\n              description: comment\n              data_type\n              default\n              is_nullable\n            }\n          }\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"service-data-sources",children:"Service data sources"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"hugr"})," query engine also supports service data sources, which are used to connect to external services or APIs (e.g., REST). These data sources can be used to fetch data from RESTful APIs or other external services."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}}}]);