"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[8480],{3874:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"graphql/queries/generated-fields","title":"Generated Fields & Transformations","description":"Hugr automatically generates special fields and arguments for certain data types, enabling powerful data transformations, extractions, and measurements directly in your GraphQL queries. This document covers the usage of generated fields for Timestamp, JSON, and Geometry types.","source":"@site/docs/5-graphql/1-queries/12-generated-fields.md","sourceDirName":"5-graphql/1-queries","slug":"/graphql/queries/generated-fields","permalink":"/docs/graphql/queries/generated-fields","draft":false,"unlisted":false,"editUrl":"https://github.com/hugr-lab/hugr-lab.github.io/docs/5-graphql/1-queries/12-generated-fields.md","tags":[],"version":"current","lastUpdatedBy":"Claude","lastUpdatedAt":1762461702000,"sidebarPosition":12,"frontMatter":{"title":"Generated Fields & Transformations","sidebar_position":12},"sidebar":"docsSidebar","previous":{"title":"Vector Similarity Search","permalink":"/docs/graphql/queries/vector-search"},"next":{"title":"Cube & Hypertable Queries","permalink":"/docs/graphql/queries/cube-hypertable"}}');var t=r(4848),a=r(8453);const s={title:"Generated Fields & Transformations",sidebar_position:12},o="Generated Fields & Transformations",d={},l=[{value:"Timestamp Field Transformations",id:"timestamp-field-transformations",level:2},{value:"Bucketing with <code>bucket</code> Argument",id:"bucketing-with-bucket-argument",level:3},{value:"Example: Sales by Month",id:"example-sales-by-month",level:4},{value:"Custom Intervals with <code>bucket_interval</code>",id:"custom-intervals-with-bucket_interval",level:3},{value:"Extracting Date Parts with <code>_&lt;field&gt;_part</code>",id:"extracting-date-parts-with-_field_part",level:3},{value:"Using <code>extract_divide</code> for Custom Units",id:"using-extract_divide-for-custom-units",level:4},{value:"Timestamp Fields in Aggregations",id:"timestamp-fields-in-aggregations",level:3},{value:"Timestamp Fields in Grouping",id:"timestamp-fields-in-grouping",level:3},{value:"Example: Orders by Day of Week",id:"example-orders-by-day-of-week",level:4},{value:"JSON Field Transformations",id:"json-field-transformations",level:2},{value:"Extracting Fields with <code>struct</code>",id:"extracting-fields-with-struct",level:3},{value:"Arrays in JSON Structure",id:"arrays-in-json-structure",level:3},{value:"JSON Path in Aggregations",id:"json-path-in-aggregations",level:3},{value:"JSON Fields in Grouping",id:"json-fields-in-grouping",level:3},{value:"Geometry Field Transformations",id:"geometry-field-transformations",level:2},{value:"Transforming Geometries",id:"transforming-geometries",level:3},{value:"Example: Finding Nearby Features",id:"example-finding-nearby-features",level:4},{value:"Measuring Geometries with <code>_&lt;field&gt;_measurement</code>",id:"measuring-geometries-with-_field_measurement",level:3},{value:"Measurements with Transformation",id:"measurements-with-transformation",level:3},{value:"Geometry Fields in Aggregations",id:"geometry-fields-in-aggregations",level:3},{value:"Geometry Fields in Grouping",id:"geometry-fields-in-grouping",level:3},{value:"Example: Buildings by Size Category",id:"example-buildings-by-size-category",level:4},{value:"Combining Generated Fields",id:"combining-generated-fields",level:2},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"1. Limit Transformations",id:"1-limit-transformations",level:3},{value:"2. Use Appropriate Measurement Types",id:"2-use-appropriate-measurement-types",level:3},{value:"3. Extract JSON Fields Selectively",id:"3-extract-json-fields-selectively",level:3},{value:"4. Bucket Before Aggregating",id:"4-bucket-before-aggregating",level:3},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Time Series Analysis",id:"time-series-analysis",level:3},{value:"Geospatial Analytics",id:"geospatial-analytics",level:3},{value:"JSON Data Extraction",id:"json-data-extraction",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Planning Errors (SQL Generation)",id:"planning-errors-sql-generation",level:3},{value:"Execution Errors (SQL Runtime)",id:"execution-errors-sql-runtime",level:3},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"generated-fields--transformations",children:"Generated Fields & Transformations"})}),"\n",(0,t.jsx)(n.p,{children:"Hugr automatically generates special fields and arguments for certain data types, enabling powerful data transformations, extractions, and measurements directly in your GraphQL queries. This document covers the usage of generated fields for Timestamp, JSON, and Geometry types."}),"\n",(0,t.jsx)(n.h2,{id:"timestamp-field-transformations",children:"Timestamp Field Transformations"}),"\n",(0,t.jsxs)(n.p,{children:["For ",(0,t.jsx)(n.code,{children:"Date"})," and ",(0,t.jsx)(n.code,{children:"Timestamp"})," fields, Hugr generates both transformation arguments and calculated fields to work with temporal data."]}),"\n",(0,t.jsxs)(n.h3,{id:"bucketing-with-bucket-argument",children:["Bucketing with ",(0,t.jsx)(n.code,{children:"bucket"})," Argument"]}),"\n",(0,t.jsx)(n.p,{children:"Transform timestamps into time buckets for grouping and analysis:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  events {\n    id\n    # Group by hour\n    created_at(bucket: hour)\n    # Group by day\n    order_date(bucket: day)\n    # Group by month\n    signup_date(bucket: month)\n  }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Available bucket values:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"minute"})," - Round down to the minute"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"hour"})," - Round down to the hour"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"day"})," - Round down to the day"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"week"})," - Round down to the week"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"month"})," - Round down to the month"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"quarter"})," - Round down to the quarter"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"year"})," - Round down to the year"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"example-sales-by-month",children:"Example: Sales by Month"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  orders {\n    id\n    total\n    # Bucket by month for time series\n    order_month: created_at(bucket: month)\n  }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Response:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "orders": [\n      {\n        "id": 1,\n        "total": 150.00,\n        "order_month": "2024-01-01T00:00:00Z"\n      },\n      {\n        "id": 2,\n        "total": 200.00,\n        "order_month": "2024-01-01T00:00:00Z"\n      },\n      {\n        "id": 3,\n        "total": 175.00,\n        "order_month": "2024-02-01T00:00:00Z"\n      }\n    ]\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.h3,{id:"custom-intervals-with-bucket_interval",children:["Custom Intervals with ",(0,t.jsx)(n.code,{children:"bucket_interval"})]}),"\n",(0,t.jsxs)(n.p,{children:["For ",(0,t.jsx)(n.code,{children:"Timestamp"})," fields, use custom time intervals:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'query {\n  sensor_readings {\n    id\n    value\n    # Bucket into 15-minute intervals\n    reading_time: timestamp(bucket_interval: "15 minutes")\n    # Bucket into 5-minute intervals\n    sample_time: timestamp(bucket_interval: "5 minutes")\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"How it works:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"2024-01-15T12:03:00Z"'})," with ",(0,t.jsx)(n.code,{children:'bucket_interval: "15 minutes"'})," \u2192 ",(0,t.jsx)(n.code,{children:'"2024-01-15T12:00:00Z"'})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"2024-01-15T12:16:00Z"'})," with ",(0,t.jsx)(n.code,{children:'bucket_interval: "15 minutes"'})," \u2192 ",(0,t.jsx)(n.code,{children:'"2024-01-15T12:15:00Z"'})]}),"\n"]}),"\n",(0,t.jsxs)(n.h3,{id:"extracting-date-parts-with-_field_part",children:["Extracting Date Parts with ",(0,t.jsx)(n.code,{children:"_<field>_part"})]}),"\n",(0,t.jsx)(n.p,{children:"Extract specific components from dates and timestamps:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  orders {\n    id\n    created_at\n    # Extract year\n    year: _created_at_part(extract: year)\n    # Extract month\n    month: _created_at_part(extract: month)\n    # Extract day of week (0 = Sunday)\n    day_of_week: _created_at_part(extract: dow)\n    # Extract hour\n    hour: _created_at_part(extract: hour)\n    # Extract Unix timestamp\n    unix_time: _created_at_part(extract: epoch)\n  }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Available extract values:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"epoch"})," - Unix timestamp (seconds since 1970-01-01)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"minute"})," - Minute (0-59)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"hour"})," - Hour (0-23)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"day"})," - Day of month (1-31)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"doy"})," - Day of year (1-366)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"dow"})," - Day of week (0 = Sunday, 6 = Saturday)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"iso_dow"})," - ISO day of week (1 = Monday, 7 = Sunday)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"week"})," - Week number"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"month"})," - Month (1-12)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"year"})," - Year"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"iso_year"})," - ISO year"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"quarter"})," - Quarter (1-4)"]}),"\n"]}),"\n",(0,t.jsxs)(n.h4,{id:"using-extract_divide-for-custom-units",children:["Using ",(0,t.jsx)(n.code,{children:"extract_divide"})," for Custom Units"]}),"\n",(0,t.jsx)(n.p,{children:"Divide extracted values for custom grouping:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  events {\n    id\n    timestamp\n    # Get 6-hour blocks (0, 6, 12, 18)\n    time_block: _timestamp_part(\n      extract: hour\n      extract_divide: 6\n    )\n    # Get 5-minute intervals\n    minute_block: _timestamp_part(\n      extract: minute\n      extract_divide: 5\n    )\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"timestamp-fields-in-aggregations",children:"Timestamp Fields in Aggregations"}),"\n",(0,t.jsx)(n.p,{children:"Use bucketing and extracted parts in aggregations:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  orders_aggregation {\n    total {\n      sum\n    }\n    # Extract year for filtering\n    _created_at_part(extract: year) {\n      avg\n      min\n      max\n    }\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"timestamp-fields-in-grouping",children:"Timestamp Fields in Grouping"}),"\n",(0,t.jsx)(n.p,{children:"Group by time buckets or extracted parts:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  orders_bucket_aggregation {\n    key {\n      # Group by month\n      order_month: created_at(bucket: month)\n      # Group by day of week\n      day_of_week: _created_at_part(extract: iso_dow)\n      # Group by hour\n      hour: _created_at_part(extract: hour)\n    }\n    aggregations {\n      _rows_count\n      total {\n        sum\n        avg\n      }\n    }\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h4,{id:"example-orders-by-day-of-week",children:"Example: Orders by Day of Week"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  orders_bucket_aggregation {\n    key {\n      day: _created_at_part(extract: iso_dow)\n    }\n    aggregations {\n      _rows_count\n      revenue: total { sum }\n    }\n  }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Response:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "orders_bucket_aggregation": [\n      {\n        "key": { "day": 1 },\n        "aggregations": {\n          "_rows_count": 45,\n          "revenue": { "sum": 5670.00 }\n        }\n      },\n      {\n        "key": { "day": 2 },\n        "aggregations": {\n          "_rows_count": 52,\n          "revenue": { "sum": 6230.00 }\n        }\n      }\n    ]\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"json-field-transformations",children:"JSON Field Transformations"}),"\n",(0,t.jsxs)(n.p,{children:["For ",(0,t.jsx)(n.code,{children:"JSON"})," fields, Hugr generates the ",(0,t.jsx)(n.code,{children:"struct"})," argument to extract specific fields and define their types."]}),"\n",(0,t.jsxs)(n.h3,{id:"extracting-fields-with-struct",children:["Extracting Fields with ",(0,t.jsx)(n.code,{children:"struct"})]}),"\n",(0,t.jsx)(n.p,{children:"Define the structure to extract only needed fields. The field remains JSON but is trimmed to the specified structure:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'query {\n  events {\n    id\n    # Extract specific fields from JSON\n    # Field remains JSON, trimmed to structure\n    metadata(struct: {\n      user_id: "int"\n      action: "string"\n      timestamp: "time"\n      details: {\n        ip_address: "string"\n        user_agent: "string"\n      }\n    })\n  }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Available type mappings:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"string"})," \u2192 GraphQL ",(0,t.jsx)(n.code,{children:"String"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"int"})," \u2192 GraphQL ",(0,t.jsx)(n.code,{children:"Int"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"bigint"})," \u2192 GraphQL ",(0,t.jsx)(n.code,{children:"BigInt"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"float"})," \u2192 GraphQL ",(0,t.jsx)(n.code,{children:"Float"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"boolean"})," \u2192 GraphQL ",(0,t.jsx)(n.code,{children:"Boolean"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"time"})," \u2192 GraphQL ",(0,t.jsx)(n.code,{children:"Timestamp"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"json"})," \u2192 GraphQL ",(0,t.jsx)(n.code,{children:"JSON"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"h3String"})," \u2192 GraphQL ",(0,t.jsx)(n.code,{children:"String"})]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"arrays-in-json-structure",children:"Arrays in JSON Structure"}),"\n",(0,t.jsx)(n.p,{children:"Extract arrays from JSON:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'query {\n  products {\n    id\n    # Struct with arrays - field remains JSON\n    metadata(struct: {\n      tags: ["string"]\n      prices: ["float"]\n      dimensions: {\n        measurements: ["float"]\n      }\n    })\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"json-path-in-aggregations",children:"JSON Path in Aggregations"}),"\n",(0,t.jsx)(n.p,{children:"Use path notation to aggregate values within JSON fields:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'query {\n  events_aggregation {\n    # Count events\n    _rows_count\n\n    # Aggregate by JSON path (use dot notation)\n    metadata {\n      # Count user_id field\n      count(path: "user_id")\n      # Sum numeric values\n      sum(path: "details.amount")\n      avg(path: "details.amount")\n      # Min/max for numbers\n      min(path: "details.score")\n      max(path: "details.score")\n      # String aggregation\n      string_agg(path: "details.category", separator: ", ")\n      # Boolean aggregation\n      bool_and(path: "is_valid")\n      bool_or(path: "is_active")\n      # List aggregation\n      list(path: "tags", distinct: true)\n      # Get any value\n      any(path: "source")\n      # Get last value\n      last(path: "status")\n    }\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Important:"})," Use dot notation (",(0,t.jsx)(n.code,{children:"field.subfield"}),") for paths, not bracket notation (",(0,t.jsx)(n.code,{children:"$.field"}),")."]}),"\n",(0,t.jsx)(n.h3,{id:"json-fields-in-grouping",children:"JSON Fields in Grouping"}),"\n",(0,t.jsx)(n.p,{children:"Group by extracted JSON fields:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'query {\n  events_bucket_aggregation {\n    key {\n      # Group by extracted JSON field (remains JSON)\n      user_segment: metadata(struct: {\n        segment: "string"\n      })\n      # Group by nested field (remains JSON)\n      country: metadata(struct: {\n        location: {\n          country: "string"\n        }\n      })\n    }\n    aggregations {\n      _rows_count\n      metadata {\n        sum(path: "revenue")\n        avg(path: "session_duration")\n      }\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"geometry-field-transformations",children:"Geometry Field Transformations"}),"\n",(0,t.jsxs)(n.p,{children:["For ",(0,t.jsx)(n.code,{children:"Geometry"})," fields, Hugr generates transformation arguments and measurement fields for spatial analysis."]}),"\n",(0,t.jsx)(n.h3,{id:"transforming-geometries",children:"Transforming Geometries"}),"\n",(0,t.jsx)(n.p,{children:"Apply transformations to geometry fields in queries:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  parcels {\n    id\n    # Original geometry\n    boundary\n\n    # Transform to different SRID\n    boundary_transformed: boundary(\n      transforms: [Transform]\n      from: 4326\n      to: 3857\n    )\n\n    # Get centroid\n    center: boundary(transforms: [Centroid])\n\n    # Create buffer (in meters for EPSG:4326)\n    buffer_zone: boundary(\n      transforms: [Buffer]\n      buffer: 100.0\n    )\n\n    # Simplify geometry\n    simplified: boundary(\n      transforms: [Simplify]\n      simplify_factor: 0.001\n    )\n\n    # Chain transformations\n    processed: boundary(\n      transforms: [Transform, Buffer, Simplify]\n      from: 4326\n      to: 3857\n      buffer: 50.0\n      simplify_factor: 0.01\n    )\n  }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Available transformations:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Transform"})," - Reproject to different CRS (requires ",(0,t.jsx)(n.code,{children:"from"})," and ",(0,t.jsx)(n.code,{children:"to"})," SRID)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Centroid"})," - Calculate geometric center"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Buffer"})," - Create buffer zone (use ",(0,t.jsx)(n.code,{children:"buffer"})," parameter)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Simplify"})," - Simplify geometry (use ",(0,t.jsx)(n.code,{children:"simplify_factor"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"SimplifyTopology"})," - Simplify preserving topology (use ",(0,t.jsx)(n.code,{children:"simplify_factor"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"StartPoint"})," - Get start point (for LineString)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"EndPoint"})," - Get end point (for LineString)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Reverse"})," - Reverse geometry direction (for LineString)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"FlipCoordinates"})," - Swap X and Y coordinates"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ConvexHull"})," - Get convex hull"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Envelope"})," - Get bounding box"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"example-finding-nearby-features",children:"Example: Finding Nearby Features"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  stores {\n    id\n    name\n    location\n    # Create 1km buffer for proximity search\n    service_area: location(\n      transforms: [Buffer]\n      buffer: 1000.0\n    )\n  }\n}\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"measuring-geometries-with-_field_measurement",children:["Measuring Geometries with ",(0,t.jsx)(n.code,{children:"_<field>_measurement"})]}),"\n",(0,t.jsx)(n.p,{children:"Calculate area, length, and perimeter:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  parcels {\n    id\n    boundary\n\n    # Calculate area (in CRS units)\n    area: _boundary_measurement(type: Area)\n\n    # Calculate area on spheroid (square meters)\n    area_m2: _boundary_measurement(type: AreaSpheroid)\n\n    # Calculate perimeter\n    perimeter: _boundary_measurement(type: Perimeter)\n\n    # Calculate perimeter on spheroid (meters)\n    perimeter_m: _boundary_measurement(type: PerimeterSpheroid)\n  }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"For LineString geometries:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  roads {\n    id\n    geometry\n\n    # Calculate length\n    length: _geometry_measurement(type: Length)\n\n    # Calculate length on spheroid (meters)\n    length_m: _geometry_measurement(type: LengthSpheroid)\n  }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Available measurement types:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Area"})," - Area in CRS units"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"AreaSpheroid"})," - Area in square meters (spheroid calculation)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Length"})," - Length in CRS units"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"LengthSpheroid"})," - Length in meters (spheroid calculation)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Perimeter"})," - Perimeter in CRS units"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"PerimeterSpheroid"})," - Perimeter in meters (spheroid calculation)"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"measurements-with-transformation",children:"Measurements with Transformation"}),"\n",(0,t.jsx)(n.p,{children:"Transform geometry before measuring:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  parcels {\n    id\n    # Transform to projected CRS before measuring\n    area_accurate: _boundary_measurement(\n      type: Area\n      transform: true\n      from: 4326\n      to: 3857\n    )\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"geometry-fields-in-aggregations",children:"Geometry Fields in Aggregations"}),"\n",(0,t.jsx)(n.p,{children:"Aggregate geometric measurements:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  parcels_aggregation {\n    # Aggregate measurements\n    _boundary_measurement(type: AreaSpheroid) {\n      sum\n      avg\n      min\n      max\n    }\n\n    # Geometric aggregations\n    boundary {\n      # Count geometries\n      count\n      # Union all geometries\n      union\n      # Find intersection\n      intersection\n      # Get extent (bounding box)\n      extent\n      # Get any geometry\n      any\n      # Get last geometry\n      last\n      # List all geometries\n      list(distinct: true)\n    }\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"geometry-fields-in-grouping",children:"Geometry Fields in Grouping"}),"\n",(0,t.jsx)(n.p,{children:"Group by transformed geometries or use in spatial grouping:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  stores_bucket_aggregation {\n    key {\n      # Group by region using centroid\n      region_center: location(transforms: [Centroid])\n    }\n    aggregations {\n      _rows_count\n      revenue { sum }\n    }\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h4,{id:"example-buildings-by-size-category",children:"Example: Buildings by Size Category"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  buildings_bucket_aggregation {\n    key {\n      # Extract area for grouping logic\n      area_value: _footprint_measurement(type: AreaSpheroid)\n    }\n    aggregations {\n      _rows_count\n      _footprint_measurement(type: AreaSpheroid) {\n        sum\n        avg\n      }\n    }\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"combining-generated-fields",children:"Combining Generated Fields"}),"\n",(0,t.jsx)(n.p,{children:"Use multiple generated fields together for complex analysis:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'query {\n  transactions_bucket_aggregation {\n    key {\n      # Time bucketing\n      month: created_at(bucket: month)\n      hour_block: _created_at_part(extract: hour, extract_divide: 6)\n\n      # JSON extraction (remains JSON)\n      user_tier: metadata(struct: {\n        tier: "string"\n      })\n\n      # Spatial grouping with transformation\n      region_center: location(transforms: [Centroid])\n    }\n    aggregations {\n      _rows_count\n      amount {\n        sum\n        avg\n      }\n      metadata {\n        avg(path: "score")\n      }\n      _location_measurement(type: AreaSpheroid) {\n        sum\n      }\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,t.jsx)(n.h3,{id:"1-limit-transformations",children:"1. Limit Transformations"}),"\n",(0,t.jsx)(n.p,{children:"Apply transformations only when needed:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"# Good - Transform only necessary fields\nquery {\n  parcels(limit: 100) {\n    id\n    area: _boundary_measurement(type: AreaSpheroid)\n  }\n}\n\n# Avoid - Transforming large geometries unnecessarily\nquery {\n  parcels {\n    id\n    boundary\n    simplified: boundary(transforms: [Simplify], simplify_factor: 0.001)\n    buffered: boundary(transforms: [Buffer], buffer: 100)\n    centroid: boundary(transforms: [Centroid])\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-use-appropriate-measurement-types",children:"2. Use Appropriate Measurement Types"}),"\n",(0,t.jsx)(n.p,{children:"Choose the right measurement type for your use case:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"# For display purposes - faster\nquery {\n  parcels {\n    id\n    area: _boundary_measurement(type: Area)\n  }\n}\n\n# For accurate real-world measurements - slower but accurate\nquery {\n  parcels {\n    id\n    area_m2: _boundary_measurement(type: AreaSpheroid)\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-extract-json-fields-selectively",children:"3. Extract JSON Fields Selectively"}),"\n",(0,t.jsx)(n.p,{children:"Only extract fields you need:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'# Good - Extract only needed fields\nquery {\n  events {\n    id\n    # Field remains JSON, trimmed to structure\n    user_id: metadata(struct: { user_id: "int" })\n  }\n}\n\n# Avoid - Extracting entire large JSON\nquery {\n  events {\n    id\n    metadata  # Returns entire JSON\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"4-bucket-before-aggregating",children:"4. Bucket Before Aggregating"}),"\n",(0,t.jsx)(n.p,{children:"Use time bucketing for efficient aggregations:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  events_bucket_aggregation {\n    key {\n      # Bucket first for efficient grouping\n      day: created_at(bucket: day)\n    }\n    aggregations {\n      _rows_count\n    }\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,t.jsx)(n.h3,{id:"time-series-analysis",children:"Time Series Analysis"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  orders_bucket_aggregation {\n    key {\n      date: created_at(bucket: day)\n      hour: _created_at_part(extract: hour)\n    }\n    aggregations {\n      _rows_count\n      revenue: total { sum }\n      avg_order: total { avg }\n    }\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"geospatial-analytics",children:"Geospatial Analytics"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  stores {\n    id\n    name\n    location\n    coverage: location(transforms: [Buffer], buffer: 5000)\n    area_km2: _location_measurement(\n      type: AreaSpheroid\n      transform: true\n    )\n  }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"json-data-extraction",children:"JSON Data Extraction"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:'query {\n  events_bucket_aggregation {\n    key {\n      # JSON field remains JSON, trimmed to structure\n      category: metadata(struct: {\n        category: "string"\n      })\n    }\n    aggregations {\n      _rows_count\n      metadata {\n        sum(path: "amount")\n        avg(path: "duration")\n        list(path: "tags", distinct: true)\n      }\n    }\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(n.h3,{id:"planning-errors-sql-generation",children:"Planning Errors (SQL Generation)"}),"\n",(0,t.jsx)(n.p,{children:"Errors caught during query planning include specific paths:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  events {\n    id\n    # Invalid extract value\n    bad_part: _created_at_part(extract: invalid)\n  }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Response:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "data": null,\n  "errors": [\n    {\n      "message": "Invalid extract value \'invalid\'. Must be one of: epoch, minute, hour, day, doy, dow, iso_dow, week, month, year, iso_year, quarter",\n      "path": ["events", "_created_at_part"],\n      "extensions": {\n        "code": "INVALID_ARGUMENT_VALUE"\n      }\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"execution-errors-sql-runtime",children:"Execution Errors (SQL Runtime)"}),"\n",(0,t.jsx)(n.p,{children:"Runtime errors during SQL execution:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-graphql",children:"query {\n  parcels {\n    id\n    # SRID transformation error at runtime\n    transformed: boundary(\n      transforms: [Transform]\n      from: 4326\n      to: 99999  # Invalid SRID\n    )\n  }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Response:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "data": null,\n  "errors": [\n    {\n      "message": "SRID 99999 not found in spatial_ref_sys table"\n    }\n  ]\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Learn about ",(0,t.jsx)(n.a,{href:"/docs/graphql/queries/function-calls",children:"Function Calls"})," for executing custom functions"]}),"\n",(0,t.jsxs)(n.li,{children:["See ",(0,t.jsx)(n.a,{href:"/docs/graphql/queries/aggregations",children:"Aggregations"})," for grouping and computing statistics"]}),"\n",(0,t.jsxs)(n.li,{children:["Check ",(0,t.jsx)(n.a,{href:"/docs/graphql/queries/spatial",children:"Spatial Queries"})," for geographic relationships"]}),"\n",(0,t.jsxs)(n.li,{children:["Review ",(0,t.jsx)(n.a,{href:"/docs/engine-configuration/schema-definition/data-types",children:"Data Types"})," for detailed type specifications"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>o});var i=r(6540);const t={},a=i.createContext(t);function s(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);