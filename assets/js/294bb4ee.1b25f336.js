"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[5634],{1404:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>d,metadata:()=>n,toc:()=>r});const n=JSON.parse('{"id":"engine-configuration/data-sources/duckdb","title":"DuckDB Data Source","description":"The DuckDB data source allows you to connect to a DuckDB database file, that can be accessed by multiple users. It can be placed in the file system or in a object storage like S3 or GCS.","source":"@site/docs/4-engine-configuration/1-data-sources/1-duckdb.md","sourceDirName":"4-engine-configuration/1-data-sources","slug":"/engine-configuration/data-sources/duckdb","permalink":"/docs/engine-configuration/data-sources/duckdb","draft":false,"unlisted":false,"editUrl":"https://github.com/hugr-lab/site/docs/4-engine-configuration/1-data-sources/1-duckdb.md","tags":[],"version":"current","lastUpdatedBy":"vgsml","lastUpdatedAt":1749389519000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"DuckDB Data Source"},"sidebar":"docsSidebar","previous":{"title":"Overview","permalink":"/docs/engine-configuration/data-sources/"},"next":{"title":"Object Storage Access Configuration","permalink":"/docs/engine-configuration/storage-access"}}');var s=t(4848),i=t(8453);const d={sidebar_position:2,title:"DuckDB Data Source"},o=void 0,c={},r=[{value:"DuckDB definition",id:"duckdb-definition",level:2},{value:"DuckDB as a dataset",id:"duckdb-as-a-dataset",level:2},{value:"DuckDB file views",id:"duckdb-file-views",level:2},{value:"Limitations",id:"limitations",level:2},{value:"DuckDB in cluster environment",id:"duckdb-in-cluster-environment",level:3},{value:"DuckDB on object storage",id:"duckdb-on-object-storage",level:3},{value:"DuckDB views",id:"duckdb-views",level:2},{value:"Self-defined data source",id:"self-defined-data-source",level:3},{value:"Performance",id:"performance",level:3},{value:"Examples",id:"examples",level:2}];function l(e){const a={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.p,{children:"The DuckDB data source allows you to connect to a DuckDB database file, that can be accessed by multiple users. It can be placed in the file system or in a object storage like S3 or GCS."}),"\n",(0,s.jsxs)(a.p,{children:["To set up a DuckDB data source you need to add data source record to the ",(0,s.jsx)(a.code,{children:"data_sources"})," table through the GraphQL API."]}),"\n",(0,s.jsxs)(a.p,{children:["The ",(0,s.jsx)(a.code,{children:"path"})," can point to a duckdb file in the accessible file system location (e.g. ",(0,s.jsx)(a.code,{children:"/workplace/my-duckdb-file.duckdb"}),") or in object storage (e.g. ",(0,s.jsx)(a.code,{children:"s3://my-bucket/my-duckdb-file.duckdb"}),"). As well it supports to use in-memory duckdb database by passing ",(0,s.jsx)(a.code,{children:":memory:"}),"."]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-graphql",children:"mutation addDuckDBDataSet($data: data_sources_mut_input_data! = {}) {\n  core {\n    insert_data_sources(data: $data) {\n      name\n      description\n      as_module\n      disabled\n      path\n      prefix\n      read_only\n      self_defined\n      type\n      catalogs {\n        name\n        description\n        path\n        type\n      }\n    }\n  }\n}\n"})}),"\n",(0,s.jsx)(a.p,{children:"Variables:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-json",children:'{\n  "data": {\n    "name": "ds",\n    "type": "duckdb",\n    "path": "/workplace/my-duckdb-file.duckdb",\n    "prefix": "ds1",\n    "description": "My DuckDB data set",\n    "read_only": false,\n    "self_defined": false,\n    "as_module": true,\n    "disabled": false,\n    "catalogs": [\n      {\n        "name": "ds_catalog",\n        "description": "",\n        "path": "",\n        "type": "duckdb"\n      }\n    ]\n  }\n}\n'})}),"\n",(0,s.jsx)(a.h2,{id:"duckdb-definition",children:"DuckDB definition"}),"\n",(0,s.jsxs)(a.p,{children:["As the database source the DuckDB data source can be marked as ",(0,s.jsx)(a.code,{children:"read_only"})," or ",(0,s.jsx)(a.code,{children:"self_defined"}),". The ",(0,s.jsx)(a.code,{children:"read_only"})," means that the data source is read-only and it cannot be modified. The ",(0,s.jsx)(a.code,{children:"self_defined"})," means that the data source is self-defined and the GraphQL schema definition will be generated base on the Table and Views metadata from the DuckDB database."]}),"\n",(0,s.jsx)(a.p,{children:"You can also add a number of catalogs to the DuckDB data source. All data source catalogs will be merged into one catalog, as well with the self-defined generated definitions."}),"\n",(0,s.jsx)(a.h2,{id:"duckdb-as-a-dataset",children:"DuckDB as a dataset"}),"\n",(0,s.jsx)(a.p,{children:"You can also see that the DuckDB databases with same structure can be used as a dataset in Hugr. We can set up a number of DuckDB databases as data sources as modules, so that the all queries will have same signatures, and you can change only root module name to switch between different datasets."}),"\n",(0,s.jsx)(a.h2,{id:"duckdb-file-views",children:"DuckDB file views"}),"\n",(0,s.jsx)(a.p,{children:"You can also use DuckDB to view the data in the files, that are stored in the object storage like S3 or GCS. The DuckDB can read the files from the object storage and you can use it as a data source in Hugr."}),"\n",(0,s.jsxs)(a.p,{children:["You can create views in the DuckDB database and use them as a dataset in ",(0,s.jsx)(a.code,{children:"hugr"})," or you can define it in the catalog sources use ",(0,s.jsx)(a.code,{children:"@view"})," directive with sql parameter to define it. It the last case you can use in memory DuckDB database to query the files without creating a physical DuckDB database file."]}),"\n",(0,s.jsx)(a.h2,{id:"limitations",children:"Limitations"}),"\n",(0,s.jsx)(a.h3,{id:"duckdb-in-cluster-environment",children:"DuckDB in cluster environment"}),"\n",(0,s.jsxs)(a.p,{children:["The DuckDB doesn't support the write operations to the same database file from different processes at the same time. So, if you are using DuckDB in the cluster environment, you should set the data source read-only to ",(0,s.jsx)(a.code,{children:"true"}),", because the DuckDB database file can be accessed by multiple users and it does not support writes to the same file from different process at the same time."]}),"\n",(0,s.jsx)(a.h3,{id:"duckdb-on-object-storage",children:"DuckDB on object storage"}),"\n",(0,s.jsx)(a.p,{children:"The database files that are stored in the object storage should be accessible only in the read-only mode."}),"\n",(0,s.jsx)(a.h2,{id:"duckdb-views",children:"DuckDB views"}),"\n",(0,s.jsx)(a.p,{children:"Currently, the DuckDB doesn't support materialized views, and querying across views can have side effects during the query optimization. So, it is recommended to use the DuckDB views only with relations that are not inside in the view base query."}),"\n",(0,s.jsx)(a.h3,{id:"self-defined-data-source",children:"Self-defined data source"}),"\n",(0,s.jsx)(a.p,{children:"Self-defined data sources can have side effects and support auto-generated relationships only for the DuckDB data source, because it uses the DuckDB metadata queries to generate the schema. For other data sources, you need to define the relationships manually."}),"\n",(0,s.jsx)(a.h3,{id:"performance",children:"Performance"}),"\n",(0,s.jsx)(a.p,{children:"The files like CSV are very slow to query, so it is recommended to load the data into the DuckDB database or parquet files to improve the performance. The DuckDB can read the parquet files directly from the object storage, so you can use it as a data source in Hugr."}),"\n",(0,s.jsx)(a.h2,{id:"examples",children:"Examples"}),"\n",(0,s.jsx)(a.p,{children:"You can find the examples of the DuckDB data source:"}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsxs)(a.li,{children:[(0,s.jsx)(a.a,{href:"/docs/examples/duckdb",children:"DuckDB: Healthcare - Providers Open Payments Data"}),"."]}),"\n"]})]})}function u(e={}){const{wrapper:a}={...(0,i.R)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,a,t)=>{t.d(a,{R:()=>d,x:()=>o});var n=t(6540);const s={},i=n.createContext(s);function d(e){const a=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),n.createElement(i.Provider,{value:a},e.children)}}}]);