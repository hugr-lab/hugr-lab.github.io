"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[1769],{2915:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"deployment/container","title":"Containerized Deployment","description":"Hugr is distributed as Docker containers hosted in the GitHub Container Registry. This page describes how to deploy hugr using Docker and Docker Compose.","source":"@site/docs/7-deployment/5-container.md","sourceDirName":"7-deployment","slug":"/deployment/container","permalink":"/docs/deployment/container","draft":false,"unlisted":false,"editUrl":"https://github.com/hugr-lab/hugr-lab.github.io/docs/7-deployment/5-container.md","tags":[],"version":"current","lastUpdatedBy":"Claude","lastUpdatedAt":1762361481000,"sidebarPosition":5,"frontMatter":{"title":"Containerized Deployment","sidebar_position":5},"sidebar":"docsSidebar","previous":{"title":"Authentication Setup","permalink":"/docs/deployment/auth"},"next":{"title":"Clustered Deployment","permalink":"/docs/deployment/cluster"}}');var i=s(4848),t=s(8453);const o={title:"Containerized Deployment",sidebar_position:5},a="Containerized Deployment",l={},d=[{value:"Container Images",id:"container-images",level:2},{value:"1. Automigrate Image (Recommended for Single-Node Deployments)",id:"1-automigrate-image-recommended-for-single-node-deployments",level:3},{value:"2. Server Image (For Cluster Work Nodes)",id:"2-server-image-for-cluster-work-nodes",level:3},{value:"3. Management Image (For Cluster Management Node)",id:"3-management-image-for-cluster-management-node",level:3},{value:"Quick Start with Docker",id:"quick-start-with-docker",level:2},{value:"Basic Deployment (Recommended)",id:"basic-deployment-recommended",level:3},{value:"With Environment File",id:"with-environment-file",level:3},{value:"Docker Compose Deployment",id:"docker-compose-deployment",level:2},{value:"Basic Deployment",id:"basic-deployment",level:3},{value:"Deployment with PostgreSQL",id:"deployment-with-postgresql",level:3},{value:"Deployment with Caching (Redis)",id:"deployment-with-caching-redis",level:3},{value:"Deployment with S3 Storage (MinIO)",id:"deployment-with-s3-storage-minio",level:3},{value:"Complete Production Setup",id:"complete-production-setup",level:3},{value:"Building Custom Images",id:"building-custom-images",level:2},{value:"Build Server Image",id:"build-server-image",level:3},{value:"Build Automigrate Image",id:"build-automigrate-image",level:3},{value:"Build Management Image",id:"build-management-image",level:3},{value:"Using Docker Compose Build",id:"using-docker-compose-build",level:3},{value:"Image Selection Guide",id:"image-selection-guide",level:2},{value:"Kubernetes Deployment",id:"kubernetes-deployment",level:2},{value:"Volume Mounts",id:"volume-mounts",level:2},{value:"Required Volumes",id:"required-volumes",level:3},{value:"Optional Volumes",id:"optional-volumes",level:3},{value:"Networking",id:"networking",level:2},{value:"Ports",id:"ports",level:3},{value:"Network Configuration",id:"network-configuration",level:3},{value:"Health Checks",id:"health-checks",level:2},{value:"Resource Limits",id:"resource-limits",level:2},{value:"Logging",id:"logging",level:2},{value:"Offline Deployment",id:"offline-deployment",level:2},{value:"Save Images",id:"save-images",level:3},{value:"Load Images",id:"load-images",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Container Won&#39;t Start",id:"container-wont-start",level:3},{value:"Connection Issues",id:"connection-issues",level:3},{value:"Performance Issues",id:"performance-issues",level:3},{value:"Example Repositories",id:"example-repositories",level:2},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"containerized-deployment",children:"Containerized Deployment"})}),"\n",(0,i.jsx)(n.p,{children:"Hugr is distributed as Docker containers hosted in the GitHub Container Registry. This page describes how to deploy hugr using Docker and Docker Compose."}),"\n",(0,i.jsx)(n.h2,{id:"container-images",children:"Container Images"}),"\n",(0,i.jsx)(n.p,{children:"Hugr provides three official Docker images:"}),"\n",(0,i.jsx)(n.h3,{id:"1-automigrate-image-recommended-for-single-node-deployments",children:"1. Automigrate Image (Recommended for Single-Node Deployments)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Image"}),": ",(0,i.jsx)(n.code,{children:"ghcr.io/hugr-lab/automigrate"})]}),"\n",(0,i.jsx)(n.p,{children:"Hugr server with automatic database schema migration for the core database. This image automatically applies schema updates on startup, making updates transparent and seamless. The automigrate image includes the same functionality as the server image, plus automatic schema migration on startup."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use this image for"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Single-node (non-clustered) deployments"}),"\n",(0,i.jsx)(n.li,{children:"Development environments"}),"\n",(0,i.jsx)(n.li,{children:"Production deployments without clustering"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull ghcr.io/hugr-lab/automigrate:latest\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2-server-image-for-cluster-work-nodes",children:"2. Server Image (For Cluster Work Nodes)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Image"}),": ",(0,i.jsx)(n.code,{children:"ghcr.io/hugr-lab/server"})]}),"\n",(0,i.jsx)(n.p,{children:"The main hugr server that provides the GraphQL API and admin interface. This is the base server image without automatic migrations."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use this image for"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Work nodes in clustered deployments"}),"\n",(0,i.jsx)(n.li,{children:"Custom migration workflows"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull ghcr.io/hugr-lab/server:latest\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-management-image-for-cluster-management-node",children:"3. Management Image (For Cluster Management Node)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Image"}),": ",(0,i.jsx)(n.code,{children:"ghcr.io/hugr-lab/management"})]}),"\n",(0,i.jsx)(n.p,{children:"Management node for cluster mode deployments. This node coordinates schema synchronization, data source configuration, object storage, and authentication settings across multiple work nodes. The management node does not provide a GraphQL API; all queries must go through work nodes. The management node also applies core database migrations at startup if the core database is not in read-only mode."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Use this image for"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Management node in clustered deployments only"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull ghcr.io/hugr-lab/management:latest\n"})}),"\n",(0,i.jsx)(n.h2,{id:"quick-start-with-docker",children:"Quick Start with Docker"}),"\n",(0,i.jsx)(n.h3,{id:"basic-deployment-recommended",children:"Basic Deployment (Recommended)"}),"\n",(0,i.jsxs)(n.p,{children:["Run a basic hugr server with local storage using the ",(0,i.jsx)(n.strong,{children:"automigrate"})," image:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run -d \\\n  --name hugr \\\n  -p 15000:15000 \\\n  -v $(pwd)/data:/data \\\n  -e CORE_DB_PATH=/data/core.db \\\n  -e ADMIN_UI=true \\\n  ghcr.io/hugr-lab/automigrate:latest\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"automigrate"})," image ensures that database schema migrations are automatically applied on startup, making updates seamless."]}),"\n",(0,i.jsxs)(n.p,{children:["Access the admin interface at ",(0,i.jsx)(n.code,{children:"http://localhost:15000/admin"})]}),"\n",(0,i.jsx)(n.h3,{id:"with-environment-file",children:"With Environment File"}),"\n",(0,i.jsxs)(n.p,{children:["Create a ",(0,i.jsx)(n.code,{children:".env"})," file:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"BIND=:15000\nADMIN_UI=true\nDEBUG=false\nCORE_DB_PATH=/data/core.db\nCACHE_L1_ENABLED=true\nCACHE_L1_MAX_SIZE=512\n"})}),"\n",(0,i.jsx)(n.p,{children:"Run with environment file:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run -d \\\n  --name hugr \\\n  -p 15000:15000 \\\n  -v $(pwd)/data:/data \\\n  --env-file .env \\\n  ghcr.io/hugr-lab/automigrate:latest\n"})}),"\n",(0,i.jsx)(n.h2,{id:"docker-compose-deployment",children:"Docker Compose Deployment"}),"\n",(0,i.jsxs)(n.p,{children:["Docker Compose provides a convenient way to manage multi-container deployments. The ",(0,i.jsx)(n.a,{href:"https://github.com/hugr-lab/docker",children:"hugr-lab/docker"})," repository contains several example configurations."]}),"\n",(0,i.jsx)(n.h3,{id:"basic-deployment",children:"Basic Deployment"}),"\n",(0,i.jsxs)(n.p,{children:["Create a ",(0,i.jsx)(n.code,{children:"docker-compose.yml"})," file using the ",(0,i.jsx)(n.strong,{children:"automigrate"})," image for automatic schema migrations:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"version: '3.8'\n\nservices:\n  hugr:\n    image: ghcr.io/hugr-lab/automigrate:latest\n    ports:\n      - \"15000:15000\"\n    environment:\n      - BIND=:15000\n      - ADMIN_UI=true\n      - CORE_DB_PATH=/data/core.db\n      - CACHE_L1_ENABLED=true\n      - CACHE_L1_MAX_SIZE=512\n    volumes:\n      - ./data:/data\n      - ./workspace:/workspace\n    restart: unless-stopped\n"})}),"\n",(0,i.jsx)(n.p,{children:"Start the service:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker-compose up -d\n"})}),"\n",(0,i.jsx)(n.h3,{id:"deployment-with-postgresql",children:"Deployment with PostgreSQL"}),"\n",(0,i.jsxs)(n.p,{children:["Use PostgreSQL as the core database for production deployments with the ",(0,i.jsx)(n.strong,{children:"automigrate"})," image:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"version: '3.8'\n\nservices:\n  hugr:\n    image: ghcr.io/hugr-lab/automigrate:latest\n    ports:\n      - \"15000:15000\"\n    environment:\n      - BIND=:15000\n      - ADMIN_UI=true\n      - CORE_DB_PATH=postgres://hugr:hugr_password@postgres:5432/hugr_core\n      - CACHE_L1_ENABLED=true\n      - CACHE_L1_MAX_SIZE=512\n    volumes:\n      - ./workspace:/workspace\n    depends_on:\n      - postgres\n    restart: unless-stopped\n\n  postgres:\n    image: postgres:15-alpine\n    environment:\n      - POSTGRES_DB=hugr_core\n      - POSTGRES_USER=hugr\n      - POSTGRES_PASSWORD=hugr_password\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n    restart: unless-stopped\n\nvolumes:\n  postgres_data:\n"})}),"\n",(0,i.jsx)(n.h3,{id:"deployment-with-caching-redis",children:"Deployment with Caching (Redis)"}),"\n",(0,i.jsxs)(n.p,{children:["Add Redis for distributed caching with the ",(0,i.jsx)(n.strong,{children:"automigrate"})," image:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  hugr:\n    image: ghcr.io/hugr-lab/automigrate:latest\n    ports:\n      - "15000:15000"\n    environment:\n      - BIND=:15000\n      - ADMIN_UI=true\n      - CORE_DB_PATH=/data/core.db\n\n      # L1 Cache\n      - CACHE_L1_ENABLED=true\n      - CACHE_L1_MAX_SIZE=512\n\n      # L2 Cache (Redis)\n      - CACHE_L2_ENABLED=true\n      - CACHE_L2_BACKEND=redis\n      - CACHE_L2_ADDRESSES=redis:6379\n      - CACHE_L2_PASSWORD=redis_password\n\n      - CACHE_TTL=10m\n    volumes:\n      - ./data:/data\n      - ./workspace:/workspace\n    depends_on:\n      - redis\n    restart: unless-stopped\n\n  redis:\n    image: redis:7-alpine\n    command: redis-server --requirepass redis_password\n    ports:\n      - "6379:6379"\n    volumes:\n      - redis_data:/data\n    restart: unless-stopped\n\nvolumes:\n  redis_data:\n'})}),"\n",(0,i.jsx)(n.h3,{id:"deployment-with-s3-storage-minio",children:"Deployment with S3 Storage (MinIO)"}),"\n",(0,i.jsxs)(n.p,{children:["Use S3-compatible storage for the core database with the ",(0,i.jsx)(n.strong,{children:"automigrate"})," image:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  hugr:\n    image: ghcr.io/hugr-lab/automigrate:latest\n    ports:\n      - "15000:15000"\n    environment:\n      - BIND=:15000\n      - ADMIN_UI=true\n      - CORE_DB_PATH=s3://hugr-bucket/core.db\n\n      # S3 Configuration (MinIO)\n      - CORE_DB_S3_ENDPOINT=http://minio:9000\n      - CORE_DB_S3_REGION=us-east-1\n      - CORE_DB_S3_KEY=minioadmin\n      - CORE_DB_S3_SECRET=minioadmin\n      - CORE_DB_S3_USE_SSL=false\n\n      # DuckDB S3 Access\n      - DB_ALLOWED_PATHS=s3://hugr-bucket/*\n    volumes:\n      - ./workspace:/workspace\n    depends_on:\n      - minio\n    restart: unless-stopped\n\n  minio:\n    image: minio/minio:latest\n    command: server /data --console-address ":9001"\n    ports:\n      - "9000:9000"\n      - "9001:9001"\n    environment:\n      - MINIO_ROOT_USER=minioadmin\n      - MINIO_ROOT_PASSWORD=minioadmin\n    volumes:\n      - minio_data:/data\n    restart: unless-stopped\n\nvolumes:\n  minio_data:\n'})}),"\n",(0,i.jsx)(n.h3,{id:"complete-production-setup",children:"Complete Production Setup"}),"\n",(0,i.jsx)(n.p,{children:"A comprehensive production-ready setup with all components:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  hugr:\n    image: ghcr.io/hugr-lab/automigrate:latest\n    ports:\n      - "15000:15000"\n      - "15001:15001"\n    environment:\n      # Server Configuration\n      - BIND=:15000\n      - SERVICE_BIND=:15001\n      - ADMIN_UI=true\n      - DEBUG=false\n      - MAX_DEPTH=7\n      - ALLOW_PARALLEL=true\n      - MAX_PARALLEL_QUERIES=20\n\n      # Core Database (PostgreSQL)\n      - CORE_DB_PATH=postgres://hugr:hugr_password@postgres:5432/hugr_core\n\n      # DuckDB Configuration\n      - DB_ALLOWED_DIRECTORIES=/workspace\n      - DB_MAX_MEMORY=8GB\n      - DB_WORKER_THREADS=4\n\n      # L1 Cache\n      - CACHE_L1_ENABLED=true\n      - CACHE_L1_MAX_SIZE=1024\n\n      # L2 Cache (Redis)\n      - CACHE_L2_ENABLED=true\n      - CACHE_L2_BACKEND=redis\n      - CACHE_L2_ADDRESSES=redis:6379\n      - CACHE_L2_PASSWORD=redis_password\n      - CACHE_TTL=10m\n\n      # CORS\n      - CORS_ALLOWED_ORIGINS=https://app.example.com\n\n      # Authentication\n      - ALLOWED_ANONYMOUS=false\n      - SECRET_KEY=${SECRET_KEY}\n    volumes:\n      - ./workspace:/workspace\n    depends_on:\n      - postgres\n      - redis\n    restart: unless-stopped\n    healthcheck:\n      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost:15001/health"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n\n  postgres:\n    image: postgres:15-alpine\n    environment:\n      - POSTGRES_DB=hugr_core\n      - POSTGRES_USER=hugr\n      - POSTGRES_PASSWORD=hugr_password\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n    restart: unless-stopped\n    healthcheck:\n      test: ["CMD-SHELL", "pg_isready -U hugr"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n\n  redis:\n    image: redis:7-alpine\n    command: redis-server --requirepass redis_password --maxmemory 512mb --maxmemory-policy allkeys-lru\n    volumes:\n      - redis_data:/data\n    restart: unless-stopped\n    healthcheck:\n      test: ["CMD", "redis-cli", "--raw", "incr", "ping"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n\nvolumes:\n  postgres_data:\n  redis_data:\n'})}),"\n",(0,i.jsx)(n.h2,{id:"building-custom-images",children:"Building Custom Images"}),"\n",(0,i.jsxs)(n.p,{children:["If you need to customize the Docker images, you can build them from source. Clone the ",(0,i.jsx)(n.a,{href:"https://github.com/hugr-lab/docker",children:"hugr-lab/docker"})," repository:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/hugr-lab/docker.git\ncd docker\n"})}),"\n",(0,i.jsx)(n.h3,{id:"build-server-image",children:"Build Server Image"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker build -t ghcr.io/hugr-lab/server:latest -f server.dockerfile .\n"})}),"\n",(0,i.jsx)(n.h3,{id:"build-automigrate-image",children:"Build Automigrate Image"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker build -t ghcr.io/hugr-lab/automigrate:latest -f automigrate.dockerfile .\n"})}),"\n",(0,i.jsx)(n.h3,{id:"build-management-image",children:"Build Management Image"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker build -t ghcr.io/hugr-lab/management:latest -f management.dockerfile .\n"})}),"\n",(0,i.jsx)(n.h3,{id:"using-docker-compose-build",children:"Using Docker Compose Build"}),"\n",(0,i.jsxs)(n.p,{children:["The repository includes a ",(0,i.jsx)(n.code,{children:"docker-compose.yml"})," file for building:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker-compose -f example.build.docker-compose.yml build\n"})}),"\n",(0,i.jsx)(n.h2,{id:"image-selection-guide",children:"Image Selection Guide"}),"\n",(0,i.jsx)(n.p,{children:"Choose the right image based on your deployment scenario:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Deployment Scenario"}),(0,i.jsx)(n.th,{children:"Recommended Image"}),(0,i.jsx)(n.th,{children:"Notes"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Single-node production"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"automigrate"})}),(0,i.jsx)(n.td,{children:"Automatic migrations on startup"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Development environment"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"automigrate"})}),(0,i.jsx)(n.td,{children:"Simplifies schema updates"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Cluster work nodes"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"server"})}),(0,i.jsx)(n.td,{children:"No automatic migrations needed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Cluster management node"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"management"})}),(0,i.jsx)(n.td,{children:"Manages cluster operations"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"kubernetes-deployment",children:"Kubernetes Deployment"}),"\n",(0,i.jsxs)(n.p,{children:["For Kubernetes deployments, see the ",(0,i.jsx)(n.a,{href:"/docs/deployment/cluster",children:"Cluster Deployment"})," guide which includes Kubernetes manifests and configuration details."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.a,{href:"https://github.com/hugr-lab/docker",children:"hugr-lab/docker"})," repository contains Kubernetes templates in the ",(0,i.jsx)(n.code,{children:"k8s/cluster"})," directory."]}),"\n",(0,i.jsx)(n.h2,{id:"volume-mounts",children:"Volume Mounts"}),"\n",(0,i.jsx)(n.h3,{id:"required-volumes",children:"Required Volumes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"/data"})})," - Core database and local DuckDB files"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"/workspace"})})," - Schema definitions and data source catalogs"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),": Volume mounting is not strictly required, but provides several benefits:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Easy editing"}),": Mount ",(0,i.jsx)(n.code,{children:"/workspace"})," to edit data source schema definition files from the host"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Database access"}),": If using DuckDB for core database, mount ",(0,i.jsx)(n.code,{children:"/data"})," directory and set the corresponding ",(0,i.jsx)(n.code,{children:"CORE_DB_PATH"})," to access the database file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Persistent secrets"}),": Mount a persistent volume to ",(0,i.jsx)(n.code,{children:"DB_HOME_DIRECTORY"})," to make secrets storage independent and avoid losing credentials when the container is removed"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"optional-volumes",children:"Optional Volumes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"/tmp"})})," - Temporary files (configure with ",(0,i.jsx)(n.code,{children:"DB_TEMP_DIRECTORY"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"/credentials"})})," - Stored credentials (configure with ",(0,i.jsx)(n.code,{children:"DB_HOME_DIRECTORY"}),")"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Example with all volumes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"volumes:\n  - ./data:/data\n  - ./workspace:/workspace\n  - ./tmp:/tmp\n  - ./credentials:/credentials\n"})}),"\n",(0,i.jsx)(n.h2,{id:"networking",children:"Networking"}),"\n",(0,i.jsx)(n.h3,{id:"ports",children:"Ports"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"15000"})," - Main GraphQL API and admin interface (default)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"15001"})," - Metrics and health check endpoint (optional, configure with ",(0,i.jsx)(n.code,{children:"SERVICE_BIND"}),")"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"network-configuration",children:"Network Configuration"}),"\n",(0,i.jsx)(n.p,{children:"For multi-container deployments, create a custom network:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"services:\n  hugr:\n    # ... service config ...\n    networks:\n      - hugr-network\n\n  postgres:\n    # ... service config ...\n    networks:\n      - hugr-network\n\nnetworks:\n  hugr-network:\n    driver: bridge\n"})}),"\n",(0,i.jsx)(n.h2,{id:"health-checks",children:"Health Checks"}),"\n",(0,i.jsx)(n.p,{children:"Configure health checks for monitoring and orchestration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'healthcheck:\n  test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost:15000/admin"]\n  interval: 30s\n  timeout: 10s\n  retries: 3\n  start_period: 40s\n'})}),"\n",(0,i.jsxs)(n.p,{children:["For the service endpoint (when ",(0,i.jsx)(n.code,{children:"SERVICE_BIND"})," is configured):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'healthcheck:\n  test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost:15001/health"]\n  interval: 30s\n  timeout: 10s\n  retries: 3\n'})}),"\n",(0,i.jsx)(n.h2,{id:"resource-limits",children:"Resource Limits"}),"\n",(0,i.jsx)(n.p,{children:"Configure resource limits to prevent container resource exhaustion:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"services:\n  hugr:\n    # ... other config ...\n    deploy:\n      resources:\n        limits:\n          cpus: '4'\n          memory: 8G\n        reservations:\n          cpus: '2'\n          memory: 4G\n"})}),"\n",(0,i.jsx)(n.h2,{id:"logging",children:"Logging"}),"\n",(0,i.jsx)(n.p,{children:"Configure logging drivers for centralized log management:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'services:\n  hugr:\n    # ... other config ...\n    logging:\n      driver: "json-file"\n      options:\n        max-size: "10m"\n        max-file: "3"\n'})}),"\n",(0,i.jsx)(n.p,{children:"For structured logging with external systems:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'logging:\n  driver: "syslog"\n  options:\n    syslog-address: "tcp://logserver:514"\n    tag: "hugr"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"offline-deployment",children:"Offline Deployment"}),"\n",(0,i.jsx)(n.p,{children:"For environments without internet access, you can save and load images:"}),"\n",(0,i.jsx)(n.h3,{id:"save-images",children:"Save Images"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Pull images\ndocker pull ghcr.io/hugr-lab/server:latest\ndocker pull postgres:15-alpine\ndocker pull redis:7-alpine\n\n# Save to tar files\ndocker save ghcr.io/hugr-lab/server:latest -o hugr-server.tar\ndocker save postgres:15-alpine -o postgres.tar\ndocker save redis:7-alpine -o redis.tar\n"})}),"\n",(0,i.jsx)(n.h3,{id:"load-images",children:"Load Images"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker load -i hugr-server.tar\ndocker load -i postgres.tar\ndocker load -i redis.tar\n"})}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(n.h3,{id:"container-wont-start",children:"Container Won't Start"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Check container logs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker logs hugr\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Verify environment variables:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker exec hugr env\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Check volume permissions:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker exec hugr ls -la /data\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"connection-issues",children:"Connection Issues"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Verify port bindings:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker ps\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Test network connectivity:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker exec hugr ping postgres\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Check firewall rules on the host"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"performance-issues",children:"Performance Issues"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Monitor resource usage:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker stats hugr\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Review DuckDB memory settings (",(0,i.jsx)(n.code,{children:"DB_MAX_MEMORY"}),")"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Adjust cache configuration"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Consider scaling to cluster mode"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"example-repositories",children:"Example Repositories"}),"\n",(0,i.jsx)(n.p,{children:"For more examples and templates, visit:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Docker Repository"}),": ",(0,i.jsx)(n.a,{href:"https://github.com/hugr-lab/docker",children:"https://github.com/hugr-lab/docker"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"compose/"})," - Docker Compose examples"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"k8s/"})," - Kubernetes templates"]}),"\n",(0,i.jsx)(n.li,{children:"Example configurations for various deployment scenarios"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Learn about ",(0,i.jsx)(n.a,{href:"/docs/deployment/cluster",children:"Cluster Deployment"})," for high availability"]}),"\n",(0,i.jsxs)(n.li,{children:["Review ",(0,i.jsx)(n.a,{href:"/docs/deployment/config",children:"Configuration"})," for detailed environment variables"]}),"\n",(0,i.jsxs)(n.li,{children:["Configure ",(0,i.jsx)(n.a,{href:"/docs/deployment/caching",children:"Caching"})," for improved performance"]}),"\n",(0,i.jsxs)(n.li,{children:["Explore ",(0,i.jsx)(n.a,{href:"/docs/deployment/auth",children:"Authentication"})," for securing your deployment"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>a});var r=s(6540);const i={},t=r.createContext(i);function o(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);