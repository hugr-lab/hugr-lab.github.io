"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[1172],{34:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"engine-configuration/schema-definition/data-objects/views","title":"Views","description":"Views are virtual tables based on SQL queries. They provide a way to simplify complex queries, create derived datasets, or provide different perspectives on your data.","source":"@site/docs/4-engine-configuration/3-schema-definition/3-data-objects/3-views.md","sourceDirName":"4-engine-configuration/3-schema-definition/3-data-objects","slug":"/engine-configuration/schema-definition/data-objects/views","permalink":"/docs/engine-configuration/schema-definition/data-objects/views","draft":false,"unlisted":false,"editUrl":"https://github.com/hugr-lab/hugr-lab.github.io/docs/4-engine-configuration/3-schema-definition/3-data-objects/3-views.md","tags":[],"version":"current","lastUpdatedBy":"vgsml","lastUpdatedAt":1756711778000,"sidebarPosition":3,"frontMatter":{"title":"Views","sidebar_position":3},"sidebar":"docsSidebar","previous":{"title":"Tables","permalink":"/docs/engine-configuration/schema-definition/data-objects/tables"},"next":{"title":"Queries","permalink":"/docs/engine-configuration/schema-definition/data-objects/queries"}}');var s=n(4848),r=n(8453);const a={title:"Views",sidebar_position:3},d="Views",o={},c=[{value:"Basic Views",id:"basic-views",level:2},{value:"Views from Existing Database Views",id:"views-from-existing-database-views",level:2},{value:"Complex Views with Joins",id:"complex-views-with-joins",level:2},{value:"Parameterized Views",id:"parameterized-views",level:2},{value:"Using Parameterized Views",id:"using-parameterized-views",level:3},{value:"Views as SQL Functions",id:"views-as-sql-functions",level:2},{value:"Adding Relations to Views",id:"adding-relations-to-views",level:2},{value:"Field Directives in Views",id:"field-directives-in-views",level:2},{value:"View Limitations",id:"view-limitations",level:2}];function l(e){const i={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.header,{children:(0,s.jsx)(i.h1,{id:"views",children:"Views"})}),"\n",(0,s.jsx)(i.p,{children:"Views are virtual tables based on SQL queries. They provide a way to simplify complex queries, create derived datasets, or provide different perspectives on your data."}),"\n",(0,s.jsx)(i.h2,{id:"basic-views",children:"Basic Views"}),"\n",(0,s.jsxs)(i.p,{children:["Define a view using the ",(0,s.jsx)(i.code,{children:"@view"})," directive:"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-graphql",children:'type active_customers @view(\n  name: "active_customers"\n  sql: """\n    SELECT * FROM customers \n    WHERE deleted_at IS NULL \n    AND last_order_date > NOW() - INTERVAL \'90 days\'\n  """\n) {\n  id: Int! @pk\n  name: String!\n  email: String!\n  last_order_date: Timestamp\n}\n'})}),"\n",(0,s.jsx)(i.h2,{id:"views-from-existing-database-views",children:"Views from Existing Database Views"}),"\n",(0,s.jsx)(i.p,{children:"If a view already exists in the database, omit the SQL parameter:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-graphql",children:'type customer_summary @view(name: "v_customer_summary") {\n  customer_id: Int! @pk\n  total_orders: Int!\n  total_spent: Float!\n  avg_order_value: Float!\n}\n'})}),"\n",(0,s.jsx)(i.h2,{id:"complex-views-with-joins",children:"Complex Views with Joins"}),"\n",(0,s.jsx)(i.p,{children:"Create views that join multiple tables:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-graphql",children:'type shipped_products_view @view(\n  name: "shipped_products"\n  sql: """\n    SELECT \n      o.customer_id,\n      o.order_date,\n      od.product_id,\n      od.quantity,\n      od.unit_price,\n      p.supplier_id,\n      p.category_id\n    FROM orders o\n    INNER JOIN order_details od ON o.id = od.order_id\n    INNER JOIN products p ON od.product_id = p.product_id\n    WHERE o.shipped_date IS NOT NULL\n  """\n) {\n  customer_id: Int!\n  order_date: Timestamp\n  product_id: Int!\n  quantity: Int!\n  unit_price: Float!\n  supplier_id: Int!\n  category_id: Int!\n}\n'})}),"\n",(0,s.jsx)(i.h2,{id:"parameterized-views",children:"Parameterized Views"}),"\n",(0,s.jsxs)(i.p,{children:["Create views that accept runtime parameters using the ",(0,s.jsx)(i.code,{children:"@args"})," directive:"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-graphql",children:'type top_customers @view(\n  name: "top_customers"\n  sql: """\n    SELECT \n      customer_id, \n      SUM(amount) as total_spent\n    FROM orders\n    WHERE \n      status = \'completed\' AND\n      order_date BETWEEN \n        COALESCE([$from], [$requested] - INTERVAL \'1 month\') \n        AND COALESCE([$to], [$requested])\n    GROUP BY customer_id\n    ORDER BY total_spent DESC\n    LIMIT COALESCE([$limit], 10)\n  """\n) @args(name: "top_customers_input", required: true) {\n  customer_id: Int!\n  total_spent: Float!\n}\n\ninput top_customers_input {\n  requested: Timestamp!\n  from: Timestamp\n  to: Timestamp\n  limit: Int = 10\n}\n'})}),"\n",(0,s.jsx)(i.h3,{id:"using-parameterized-views",children:"Using Parameterized Views"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-graphql",children:'query {\n  top_customers(args: {\n    requested: "2024-01-01T00:00:00Z"\n    from: "2023-01-01T00:00:00Z"\n    to: "2023-12-31T23:59:59Z"\n    limit: 20\n  }) {\n    customer_id\n    total_spent\n    customer {\n      name\n      email\n    }\n  }\n}\n'})}),"\n",(0,s.jsx)(i.h2,{id:"views-as-sql-functions",children:"Views as SQL Functions"}),"\n",(0,s.jsx)(i.p,{children:"For database functions that return record sets:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-graphql",children:'type weather_data @view(name: "get_weather_for_location") \n  @args(name: "weather_input", required: true) {\n  location: String!\n  temperature: Float!\n  humidity: Float!\n  recorded_at: Timestamp!\n}\n\ninput weather_input {\n  location_id: Int!\n  date_from: Timestamp! \n  date_to: Timestamp!\n  include_forecasts: Boolean @named(name: "with_forecast")\n}\n'})}),"\n",(0,s.jsxs)(i.p,{children:["The ",(0,s.jsx)(i.code,{children:"@named"})," directive specifies named parameters for SQL functions."]}),"\n",(0,s.jsx)(i.h2,{id:"adding-relations-to-views",children:"Adding Relations to Views"}),"\n",(0,s.jsx)(i.p,{children:"Views can have foreign key relationships just like tables:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-graphql",children:'type order_summary @view(name: "order_summary") {\n  order_id: Int! @pk\n  customer_id: Int! @field_references(\n    references_name: "customers"\n    field: "id"\n    query: "customer"\n    references_query: "order_summaries"\n  )\n  total_amount: Float!\n  order_date: Timestamp\n}\n'})}),"\n",(0,s.jsx)(i.h2,{id:"field-directives-in-views",children:"Field Directives in Views"}),"\n",(0,s.jsxs)(i.p,{children:["You can use field-level directives in view definitions just like in table definitions. Supported directives include: ",(0,s.jsx)(i.code,{children:"@field_source"}),", ",(0,s.jsx)(i.code,{children:"@sql"}),", ",(0,s.jsx)(i.code,{children:"@field_references"}),", ",(0,s.jsx)(i.code,{children:"@filter_required"}),", ",(0,s.jsx)(i.code,{children:"@timescale_key"}),", ",(0,s.jsx)(i.code,{children:"@pk"}),", ",(0,s.jsx)(i.code,{children:"@unique"}),", ",(0,s.jsx)(i.code,{children:"@geometry_info"}),", ",(0,s.jsx)(i.code,{children:"@mesurement"}),", ",(0,s.jsx)(i.code,{children:"@join"}),", and ",(0,s.jsx)(i.code,{children:"@function_call"}),". These directives allow you to control field mapping, relationships, constraints, and additional metadata for fields within views."]}),"\n",(0,s.jsx)(i.h2,{id:"view-limitations",children:"View Limitations"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsx)(i.li,{children:"Views are read-only by default (no mutations generated)"}),"\n",(0,s.jsx)(i.li,{children:"Cannot have sequences or default values"}),"\n",(0,s.jsx)(i.li,{children:"Performance depends on underlying query complexity"}),"\n",(0,s.jsx)(i.li,{children:"Indexes should be created on base tables, not views"}),"\n"]})]})}function u(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>a,x:()=>d});var t=n(6540);const s={},r=t.createContext(s);function a(e){const i=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:i},e.children)}}}]);