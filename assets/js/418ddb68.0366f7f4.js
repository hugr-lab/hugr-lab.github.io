"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[5826],{1465:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"engine-configuration/schema-definition/data-objects/tables","title":"Tables","description":"Tables are the primary data objects in Hugr, corresponding to physical tables in the underlying database. They support full CRUD operations through the generated GraphQL API.","source":"@site/docs/4-engine-configuration/3-schema-definition/3-data-objects/2-tables.md","sourceDirName":"4-engine-configuration/3-schema-definition/3-data-objects","slug":"/engine-configuration/schema-definition/data-objects/tables","permalink":"/docs/engine-configuration/schema-definition/data-objects/tables","draft":false,"unlisted":false,"editUrl":"https://github.com/hugr-lab/hugr-lab.github.io/docs/4-engine-configuration/3-schema-definition/3-data-objects/2-tables.md","tags":[],"version":"current","lastUpdatedBy":"vgsml","lastUpdatedAt":1756711778000,"sidebarPosition":2,"frontMatter":{"title":"Tables","sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Data Objects Overview","permalink":"/docs/engine-configuration/schema-definition/data-objects/overview"},"next":{"title":"Views","permalink":"/docs/engine-configuration/schema-definition/data-objects/views"}}');var i=t(4848),a=t(8453);const l={title:"Tables",sidebar_position:2},r="Tables",d={},c=[{value:"Defining Tables",id:"defining-tables",level:2},{value:"Table Directive Parameters",id:"table-directive-parameters",level:3},{value:"Primary Keys",id:"primary-keys",level:2},{value:"Unique Constraints",id:"unique-constraints",level:2},{value:"Field Mapping",id:"field-mapping",level:2},{value:"Calculated Fields",id:"calculated-fields",level:2},{value:"Default Values and Sequences",id:"default-values-and-sequences",level:2},{value:"Soft Delete",id:"soft-delete",level:2},{value:"Many-to-Many Tables",id:"many-to-many-tables",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"tables",children:"Tables"})}),"\n",(0,i.jsx)(n.p,{children:"Tables are the primary data objects in Hugr, corresponding to physical tables in the underlying database. They support full CRUD operations through the generated GraphQL API."}),"\n",(0,i.jsx)(n.h2,{id:"defining-tables",children:"Defining Tables"}),"\n",(0,i.jsxs)(n.p,{children:["Tables are defined using the ",(0,i.jsx)(n.code,{children:"@table"})," directive on a GraphQL type:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type customers @table(name: "customers") {\n  id: Int! @pk\n  name: String!\n  email: String!\n  created_at: Timestamp\n  deleted_at: Timestamp\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"table-directive-parameters",children:"Table Directive Parameters"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"name"})," - Physical table name in the database"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"is_m2m"})," - Marks table as many-to-many relationship (default: false)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"soft_delete"})," - Enable soft delete functionality (default: false)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"soft_delete_cond"})," - SQL condition to check if record is deleted"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"soft_delete_set"})," - SQL statement to mark record as deleted"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"primary-keys",children:"Primary Keys"}),"\n",(0,i.jsxs)(n.p,{children:["Use the ",(0,i.jsx)(n.code,{children:"@pk"})," directive to define primary key fields:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type orders @table(name: "orders") {\n  id: Int! @pk\n  company_id: Int! @pk  # Composite primary key\n  customer_id: Int!\n  total: Float!\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Primary keys enable:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Generation of ",(0,i.jsx)(n.code,{children:"<table>_by_pk"})," queries"]}),"\n",(0,i.jsx)(n.li,{children:"Return of inserted records in mutations"}),"\n",(0,i.jsx)(n.li,{children:"Optimized single-record queries"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"unique-constraints",children:"Unique Constraints"}),"\n",(0,i.jsxs)(n.p,{children:["Define unique constraints using the ",(0,i.jsx)(n.code,{children:"@unique"})," directive:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type customers @table(name: "customers") \n  @unique(fields: ["email"])\n  @unique(fields: ["tax_id", "country"], query_suffix: "by_tax") {\n  id: Int! @pk\n  email: String!\n  tax_id: String!\n  country: String!\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"This generates additional queries:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"customers_by_email"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"customers_by_tax"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"field-mapping",children:"Field Mapping"}),"\n",(0,i.jsxs)(n.p,{children:["Map GraphQL fields to database columns using ",(0,i.jsx)(n.code,{children:"@field_source"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type customers @table(name: "customers") {\n  id: String! @pk @field_source(field: "customer_id")\n  companyName: String! @field_source(field: "company_name")\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"calculated-fields",children:"Calculated Fields"}),"\n",(0,i.jsxs)(n.p,{children:["Add calculated fields using the ",(0,i.jsx)(n.code,{children:"@sql"})," directive:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type order_details @table(name: "order_details") {\n  unit_price: Float! @field_source(field: "price")\n  quantity: Int!\n  discount: Float!\n  total: Float! @sql(exp: "round((objects.price * [quantity] * (1 - [discount]))*100)/100")\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Note:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["To reference data object fields within SQL expressions, use the field names enclosed in square brackets ",(0,i.jsx)(n.code,{children:"[field_name]"}),". This applies to both calculated fields and fields that have been renamed using the ",(0,i.jsx)(n.code,{children:"@field_source"})," directive."]}),"\n",(0,i.jsxs)(n.li,{children:["If you need to access the original source field directly, use the data object alias ",(0,i.jsx)(n.code,{children:"objects"})," with dot notation, for example: ",(0,i.jsx)(n.code,{children:"objects.<field_name>"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"default-values-and-sequences",children:"Default Values and Sequences"}),"\n",(0,i.jsx)(n.p,{children:"Define default values or sequences for auto-generated IDs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type customers @table(name: "customers") {\n  id: Int! @pk @default(sequence: "customers_id_seq")\n  status: String! @default(value: "active")\n  created_at: Timestamp!\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"soft-delete",children:"Soft Delete"}),"\n",(0,i.jsx)(n.p,{children:"Enable soft delete to mark records as deleted without physical removal:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type customers @table(\n  name: "customers"\n  soft_delete: true\n  soft_delete_cond: "deleted_at IS NULL"\n  soft_delete_set: "deleted_at = NOW()"\n) {\n  id: Int! @pk\n  name: String!\n  deleted_at: Timestamp\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"many-to-many-tables",children:"Many-to-Many Tables"}),"\n",(0,i.jsx)(n.p,{children:"Define junction tables for many-to-many relationships:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-graphql",children:'type customer_types @table(name: "customer_customer_demo", is_m2m: true) {\n  customer_id: String! @pk @field_references(\n    references_name: "customers"\n    field: "id"\n    query: "customer"\n    references_query: "types"\n  )\n  type_id: String! @pk @field_references(\n    references_name: "customer_types"\n    field: "id"\n    query: "type"\n    references_query: "customers"\n  )\n}\n'})})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>r});var s=t(6540);const i={},a=s.createContext(i);function l(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);