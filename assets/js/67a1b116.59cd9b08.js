"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[2650],{5590:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"engine-configuration/storage-access","title":"Object Storage Access Configuration","description":"The hugr engine supports access to files stored in object storage systems, such as Local S3 (MinIO), AWS S3, Google Cloud Storage, Cloudflare R2, or Azure Blob Storage. This allows you to work with large datasets, files, or other binary data directly from your queries and mutations.","source":"@site/docs/4-engine-configuration/2-storage-access.md","sourceDirName":"4-engine-configuration","slug":"/engine-configuration/storage-access","permalink":"/docs/engine-configuration/storage-access","draft":false,"unlisted":false,"editUrl":"https://github.com/hugr-lab/hugr-lab.github.io/docs/4-engine-configuration/2-storage-access.md","tags":[],"version":"current","lastUpdatedBy":"vgsml","lastUpdatedAt":1756198624000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Object Storage Access Configuration"},"sidebar":"docsSidebar","previous":{"title":"Extensions & Cross-Source Subqueries","permalink":"/docs/engine-configuration/data-sources/extension"},"next":{"title":"Schema definitions","permalink":"/docs/category/schema-definitions"}}');var r=n(4848),i=n(8453);const o={sidebar_position:3,title:"Object Storage Access Configuration"},c=void 0,a={},d=[{value:"Register a new object storage",id:"register-a-new-object-storage",level:2},{value:"Unregister an object storage",id:"unregister-an-object-storage",level:2},{value:"Registered Object Storage",id:"registered-object-storage",level:2}];function l(t){const e={code:"code",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...t.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(e.p,{children:["The ",(0,r.jsx)(e.code,{children:"hugr"})," engine supports access to files stored in object storage systems, such as Local S3 (MinIO), AWS S3, Google Cloud Storage, Cloudflare R2, or Azure Blob Storage. This allows you to work with large datasets, files, or other binary data directly from your queries and mutations."]}),"\n",(0,r.jsx)(e.p,{children:"To configure object storage access, you need to provide the necessary credentials and connection settings for the object storage system you are using. This can be done through the unified GraphQL API."}),"\n",(0,r.jsxs)(e.p,{children:["Once object storage access is configured, you can use the ",(0,r.jsx)(e.code,{children:"hugr"})," engine to read and write files to the object storage system as part of your data processing workflows."]}),"\n",(0,r.jsx)(e.p,{children:"Currently, GraphQL mutations are implemented for S3-compatible object storages. Support for Azure Blob Storage and Azure Data Lake Storage is in development."}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"hugr"})," allows you to use multiple object storages simultaneously; the credentials will apply by scope (path prefix)."]}),"\n",(0,r.jsxs)(e.p,{children:["You can use object storage to store schema definition files (catalog source type ",(0,r.jsx)(e.code,{children:"uri"})," or ",(0,r.jsx)(e.code,{children:"uriFile"}),"), DuckDB database files (DuckDB data sources), and data files to create file views (CSV, Parquet, ESRI Shapefile, GeoPackage, JSON, GeoJSON, etc.)"]}),"\n",(0,r.jsx)(e.h2,{id:"register-a-new-object-storage",children:"Register a new object storage"}),"\n",(0,r.jsx)(e.p,{children:"To allow access to a new object storage system, you need to provide the necessary credentials and URLs for the object storage system you are using. This can be done through the unified GraphQL API."}),"\n",(0,r.jsx)(e.p,{children:"To register a new object storage in standalone mode, you can use the following mutation:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-graphql",children:"mutation(\n\t\t$type: String!,\n\t\t$name: String!,\n\t\t$key: String!,\n\t\t$secret: String!,\n\t\t$region: String!,\n\t\t$endpoint: String!,\n\t\t$scope: String!,\n\t\t$use_ssl: Boolean!,\n\t\t$url_style: String!,\n\t\t$url_compatibility: Boolean,\n\t\t$kms_key_id: String,\n\t\t$account_id: String\n\t){\n\t\tfunction {\n\t\t\tcore {\n\t\t\t\tstorage {\n\t\t\t\t\tregister_object_storage(\n\t\t\t\t\t\ttype: $type,\n\t\t\t\t\t\tname: $name,\n\t\t\t\t\t\tkey: $key,\n\t\t\t\t\t\tsecret: $secret,\n\t\t\t\t\t\tregion: $region,\n\t\t\t\t\t\tendpoint: $endpoint,\n\t\t\t\t\t\tscope: $scope,\n\t\t\t\t\t\tuse_ssl: $use_ssl,\n\t\t\t\t\t\turl_style: $url_style,\n\t\t\t\t\t\turl_compatibility: $url_compatibility,\n\t\t\t\t\t\tkms_key_id: $kms_key_id,\n\t\t\t\t\t\taccount_id: $account_id\n\t\t\t\t\t) {\n\t\t\t\t\t\tsuccess\n\t\t\t\t\t\tmessage\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"})}),"\n",(0,r.jsx)(e.p,{children:"To register a new object storage in cluster mode (it will propagate to all nodes), you can use the following mutation:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-graphql",children:"mutation(\n\t\t$type: String!,\n\t\t$name: String!,\n\t\t$key: String!,\n\t\t$secret: String!,\n\t\t$region: String!,\n\t\t$endpoint: String!,\n\t\t$scope: String!,\n\t\t$use_ssl: Boolean!,\n\t\t$url_style: String!,\n\t\t$url_compatibility: Boolean,\n\t\t$kms_key_id: String,\n\t\t$account_id: String\n\t){\n\t\tfunction {\n\t\t\tcore {\n\t\t\t\tcluster {\n\t\t\t\t\tregister_object_storage(\n\t\t\t\t\t\ttype: $type,\n\t\t\t\t\t\tname: $name,\n\t\t\t\t\t\tkey: $key,\n\t\t\t\t\t\tsecret: $secret,\n\t\t\t\t\t\tregion: $region,\n\t\t\t\t\t\tendpoint: $endpoint,\n\t\t\t\t\t\tscope: $scope,\n\t\t\t\t\t\tuse_ssl: $use_ssl,\n\t\t\t\t\t\turl_style: $url_style,\n\t\t\t\t\t\turl_compatibility: $url_compatibility,\n\t\t\t\t\t\tkms_key_id: $kms_key_id,\n\t\t\t\t\t\taccount_id: $account_id\n\t\t\t\t\t) {\n\t\t\t\t\t\tsuccess\n\t\t\t\t\t\tmessage\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"})}),"\n",(0,r.jsxs)(e.p,{children:["The scope should be provided as a path prefix, for example: ",(0,r.jsx)(e.code,{children:"s3://my-bucket/prefix/"}),"."]}),"\n",(0,r.jsx)(e.p,{children:"The parameter descriptions are in the table below:"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"Name"}),(0,r.jsx)(e.th,{children:"Description"}),(0,r.jsx)(e.th,{children:"Applies to"}),(0,r.jsx)(e.th,{children:"Type"}),(0,r.jsx)(e.th,{children:"Default"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"type"}),(0,r.jsx)(e.td,{children:"The type of the object storage (S3, GCS, R2)"}),(0,r.jsx)(e.td,{}),(0,r.jsx)(e.td,{children:"STRING"}),(0,r.jsx)(e.td,{children:"-"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"name"}),(0,r.jsx)(e.td,{children:"The name of the object storage"}),(0,r.jsx)(e.td,{}),(0,r.jsx)(e.td,{children:"STRING"}),(0,r.jsx)(e.td,{children:"-"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"scope"}),(0,r.jsx)(e.td,{children:"The scope of the object storage"}),(0,r.jsx)(e.td,{}),(0,r.jsx)(e.td,{children:"STRING"}),(0,r.jsx)(e.td,{children:"-"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"endpoint"}),(0,r.jsx)(e.td,{children:"Specify a custom S3 endpoint"}),(0,r.jsx)(e.td,{children:"S3, GCS, R2"}),(0,r.jsx)(e.td,{children:"STRING"}),(0,r.jsx)(e.td,{children:"s3.amazonaws.com for S3"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"key"}),(0,r.jsx)(e.td,{children:"The ID of the key to use"}),(0,r.jsx)(e.td,{children:"S3, GCS, R2"}),(0,r.jsx)(e.td,{children:"STRING"}),(0,r.jsx)(e.td,{children:"-"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"region"}),(0,r.jsx)(e.td,{children:"The region for which to authenticate (should match the region of the bucket to query)"}),(0,r.jsx)(e.td,{children:"S3, GCS, R2"}),(0,r.jsx)(e.td,{children:"STRING"}),(0,r.jsx)(e.td,{children:"us-east-1"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"secret"}),(0,r.jsx)(e.td,{children:"The secret of the key to use"}),(0,r.jsx)(e.td,{children:"S3, GCS, R2"}),(0,r.jsx)(e.td,{children:"STRING"}),(0,r.jsx)(e.td,{children:"-"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"url_compatibility"}),(0,r.jsx)(e.td,{children:"Can help when URLs contain problematic characters"}),(0,r.jsx)(e.td,{children:"S3, GCS, R2"}),(0,r.jsx)(e.td,{children:"BOOLEAN"}),(0,r.jsx)(e.td,{children:"true"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"url_style"}),(0,r.jsx)(e.td,{children:"Either vhost or path"}),(0,r.jsx)(e.td,{children:"S3, GCS, R2"}),(0,r.jsx)(e.td,{children:"STRING"}),(0,r.jsx)(e.td,{children:"vhost for S3, path for R2 and GCS"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"use_ssl"}),(0,r.jsx)(e.td,{children:"Whether to use HTTPS or HTTP"}),(0,r.jsx)(e.td,{children:"S3, GCS, R2"}),(0,r.jsx)(e.td,{children:"BOOLEAN"}),(0,r.jsx)(e.td,{children:"true"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"account_id"}),(0,r.jsx)(e.td,{children:"The R2 account ID to use for generating the endpoint URL"}),(0,r.jsx)(e.td,{children:"R2"}),(0,r.jsx)(e.td,{children:"STRING"}),(0,r.jsx)(e.td,{children:"-"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"kms_key_id"}),(0,r.jsx)(e.td,{children:"AWS KMS (Key Management Service) key for Server Side Encryption S3"}),(0,r.jsx)(e.td,{children:"S3"}),(0,r.jsx)(e.td,{children:"STRING"}),(0,r.jsx)(e.td,{children:"-"})]})]})]}),"\n",(0,r.jsx)(e.h2,{id:"unregister-an-object-storage",children:"Unregister an object storage"}),"\n",(0,r.jsx)(e.p,{children:"To unregister an object storage, you can use the following mutation:"}),"\n",(0,r.jsx)(e.p,{children:"In standalone mode:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-graphql",children:"mutation(\n\t\t$name: String!\n\t){\n\t\tfunction {\n\t\t\tcore {\n\t\t\t\tstorage {\n\t\t\t\t\tunregister_object_storage(\n\t\t\t\t\t\tname: $name\n\t\t\t\t\t) {\n\t\t\t\t\t\tsuccess\n\t\t\t\t\t\tmessage\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"})}),"\n",(0,r.jsx)(e.p,{children:"In cluster mode (it will propagate to all nodes):"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-graphql",children:"mutation(\n\t\t$name: String!\n\t){\n\t\tfunction {\n\t\t\tcore {\n\t\t\t\tcluster {\n\t\t\t\t\tunregister_object_storage(\n\t\t\t\t\t\tname: $name\n\t\t\t\t\t) {\n\t\t\t\t\t\tsuccess\n\t\t\t\t\t\tmessage\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"})}),"\n",(0,r.jsx)(e.h2,{id:"registered-object-storage",children:"Registered Object Storage"}),"\n",(0,r.jsx)(e.p,{children:"To list all registered object storages, you can use the following query:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-graphql",children:"query {\n\tfunction {\n\t\tcore {\n\t\t\tstorage {\n\t\t\t\tregistered_object_storages {\n\t\t\t\t\tname\n\t\t\t\t\ttype\n\t\t\t\t\tregion\n\t\t\t\t\tendpoint\n\t\t\t\t\tscope\n\t\t\t\t\tuse_ssl\n\t\t\t\t\turl_style\n\t\t\t\t\turl_compatibility\n\t\t\t\t\tkms_key_id\n\t\t\t\t\taccount_id\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n"})}),"\n",(0,r.jsx)(e.p,{children:"In cluster mode:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-graphql",children:"query {\n\tfunction {\n\t\tcore {\n\t\t\tcluster {\n\t\t\t\tregistered_object_storages {\n                    node\n\t\t\t\t\tname\n\t\t\t\t\ttype\n\t\t\t\t\tregion\n\t\t\t\t\tendpoint\n\t\t\t\t\tscope\n\t\t\t\t\tuse_ssl\n\t\t\t\t\turl_style\n\t\t\t\t\turl_compatibility\n\t\t\t\t\tkms_key_id\n\t\t\t\t\taccount_id\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n"})})]})}function h(t={}){const{wrapper:e}={...(0,i.R)(),...t.components};return e?(0,r.jsx)(e,{...t,children:(0,r.jsx)(l,{...t})}):l(t)}},8453:(t,e,n)=>{n.d(e,{R:()=>o,x:()=>c});var s=n(6540);const r={},i=s.createContext(r);function o(t){const e=s.useContext(i);return s.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function c(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(r):t.components||r:o(t.components),s.createElement(i.Provider,{value:e},t.children)}}}]);