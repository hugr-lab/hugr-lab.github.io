"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[2939],{1420:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>c,metadata:()=>t,toc:()=>r});const t=JSON.parse('{"id":"engine-configuration/schema-definition/data-objects/function-calls","title":"Function Calls","description":"For calling functions across different data sources using extensions, see Extensions & Cross-Source Subqueries.","source":"@site/docs/4-engine-configuration/3-schema-definition/3-data-objects/9-function-calls.md","sourceDirName":"4-engine-configuration/3-schema-definition/3-data-objects","slug":"/engine-configuration/schema-definition/data-objects/function-calls","permalink":"/docs/engine-configuration/schema-definition/data-objects/function-calls","draft":false,"unlisted":false,"editUrl":"https://github.com/hugr-lab/hugr-lab.github.io/docs/4-engine-configuration/3-schema-definition/3-data-objects/9-function-calls.md","tags":[],"version":"current","lastUpdatedBy":"Claude","lastUpdatedAt":1762714317000,"sidebarPosition":9,"frontMatter":{"title":"Function Calls","sidebar_position":9},"sidebar":"docsSidebar","previous":{"title":"Joins and Spatial Joins","permalink":"/docs/engine-configuration/schema-definition/data-objects/joins"},"next":{"title":"Special Table Types","permalink":"/docs/engine-configuration/schema-definition/data-objects/special-types"}}');var a=i(4848),s=i(8453);const c={title:"Function Calls",sidebar_position:9},o="Function Calls",l={},r=[{value:"Basic Function Calls",id:"basic-function-calls",level:2},{value:"Partial Argument Mapping",id:"partial-argument-mapping",level:2},{value:"Table Function Calls",id:"table-function-calls",level:2},{value:"Table Function with Join",id:"table-function-with-join",level:2},{value:"HTTP API Function Calls",id:"http-api-function-calls",level:2},{value:"Cross-Source Function Calls",id:"cross-source-function-calls",level:2},{value:"Conditional Function Calls",id:"conditional-function-calls",level:2},{value:"Function Calls in Aggregations",id:"function-calls-in-aggregations",level:2},{value:"Chained Function Calls",id:"chained-function-calls",level:2},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Efficient Function Execution",id:"efficient-function-execution",level:3},{value:"Limiting Function Executions",id:"limiting-function-executions",level:3}];function d(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"function-calls",children:"Function Calls"})}),"\n",(0,a.jsx)(e.admonition,{title:"Cross-Source Function Calls",type:"tip",children:(0,a.jsxs)(e.p,{children:["For calling functions across different data sources using extensions, see ",(0,a.jsx)(e.a,{href:"/docs/engine-configuration/extension#extending-types-with-cross-source-function-calls",children:"Extensions & Cross-Source Subqueries"}),"."]})}),"\n",(0,a.jsx)(e.p,{children:"Hugr allows you to extend data objects with function call fields, enabling dynamic computations, external API calls, and custom business logic directly within your GraphQL queries."}),"\n",(0,a.jsx)(e.h2,{id:"basic-function-calls",children:"Basic Function Calls"}),"\n",(0,a.jsxs)(e.p,{children:["Add a function result as a field using ",(0,a.jsx)(e.code,{children:"@function_call"}),":"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:'# Define the function\nextend type Function {\n  calculate_discount(\n    customer_id: Int!\n    order_total: Float!\n  ): Float @function(name: "calculate_customer_discount")\n}\n\n# Add as field to orders\nextend type orders {\n  discount: Float @function_call(\n    references_name: "calculate_discount"\n    args: {\n      customer_id: "customer_id"\n      order_total: "total"\n    }\n  )\n}\n'})}),"\n",(0,a.jsx)(e.p,{children:"Query the function result:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:"query {\n  orders {\n    id\n    total\n    discount  # Automatically calculated\n  }\n}\n"})}),"\n",(0,a.jsxs)(e.p,{children:["Note: The ",(0,a.jsx)(e.code,{children:"@sql"})," directive is used in the schema definition to create calculated fields, not in queries."]}),"\n",(0,a.jsx)(e.h2,{id:"partial-argument-mapping",children:"Partial Argument Mapping"}),"\n",(0,a.jsx)(e.p,{children:"Map some arguments from fields, others from query:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:'extend type products {\n  price_in_currency: Float @function_call(\n    references_name: "convert_price"\n    args: {\n      amount: "price"  # From product.price field\n      # currency parameter will be added to query\n    }\n  )\n}\n'})}),"\n",(0,a.jsx)(e.p,{children:"Query with additional arguments:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:'query {\n  products {\n    id\n    price\n    price_in_currency(currency: "EUR")\n  }\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"table-function-calls",children:"Table Function Calls"}),"\n",(0,a.jsx)(e.p,{children:"Call functions that return multiple rows:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:'extend type Function {\n  get_recommendations(\n    product_id: Int!\n    limit: Int = 5\n  ): [recommended_product] @function(\n    name: "get_product_recommendations"\n    is_table: true\n  )\n}\n\nextend type products {\n  recommendations: [recommended_product] @function_call(\n    references_name: "get_recommendations"\n    args: {\n      product_id: "id"\n    }\n  )\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"table-function-with-join",children:"Table Function with Join"}),"\n",(0,a.jsxs)(e.p,{children:["The ",(0,a.jsx)(e.code,{children:"@table_function_call_join"})," directive combines function results with join conditions. This allows basic data retrieval with argument mapping and join operations:"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:'extend type sensors {\n  readings: [sensor_reading] @table_function_call_join(\n    references_name: "get_sensor_readings"\n    args: {\n      sensor_id: "id"\n    }\n    source_fields: ["id"]\n    references_fields: ["sensor_id"]\n  )\n}\n'})}),"\n",(0,a.jsx)(e.p,{children:"Note: For advanced filtering, sorting, and aggregation of function results, consider using parameterized views instead."}),"\n",(0,a.jsx)(e.h2,{id:"http-api-function-calls",children:"HTTP API Function Calls"}),"\n",(0,a.jsx)(e.p,{children:"Call external APIs as functions:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:'extend type Function {\n  get_weather(\n    lat: Float!\n    lon: Float!\n  ): weather_data @function(\n    name: "fetch_weather"\n    sql: """\n      http_data_source_request_scalar(\n        \'[$catalog]\',\n        \'/weather\',\n        \'GET\',\n        \'{}\'::JSON,\n        {lat: [lat], lon: [lon]}::JSON,\n        \'{}\'::JSON,\n        \'\'\n      )\n    """\n    json_cast: true\n  )\n}\n\nextend type locations {\n  current_weather: weather_data @function_call(\n    references_name: "get_weather"\n    args: {\n      lat: "latitude"\n      lon: "longitude"\n    }\n  )\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"cross-source-function-calls",children:"Cross-Source Function Calls"}),"\n",(0,a.jsx)(e.p,{children:"Call functions from different data sources in extensions:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:'# In extension data source\nextend type postgres_customers {\n  # Call MySQL function\n  credit_score: Float @function_call(\n    references_name: "calculate_credit_score"\n    module: "mysql"\n    args: {\n      customer_id: "id"\n    }\n  )\n  \n  # Call HTTP API function\n  social_profile: social_data @function_call(\n    references_name: "get_social_profile"\n    module: "social_api"\n    args: {\n      email: "email"\n    }\n  )\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"conditional-function-calls",children:"Conditional Function Calls"}),"\n",(0,a.jsx)(e.p,{children:"Functions can handle null values:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:'extend type Function {\n  geocode_address(\n    address: String\n  ): Geometry @function(\n    name: "geocode"\n    skip_null_arg: true  # Don\'t call if address is null\n  )\n}\n\nextend type customers {\n  location: Geometry @function_call(\n    references_name: "geocode_address"\n    args: {\n      address: "full_address"\n    }\n  )\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"function-calls-in-aggregations",children:"Function Calls in Aggregations"}),"\n",(0,a.jsx)(e.p,{children:"When using function calls that return arrays, you can aggregate the results:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:'extend type products {\n  reviews: [review] @function_call(\n    references_name: "get_product_reviews"\n    args: { product_id: "id" }\n  )\n}\n'})}),"\n",(0,a.jsx)(e.p,{children:"Query with aggregation:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:"query {\n  products {\n    id\n    name\n    reviews_aggregation {\n      _rows_count\n      rating {\n        avg\n        count\n      }\n    }\n  }\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"chained-function-calls",children:"Chained Function Calls"}),"\n",(0,a.jsx)(e.p,{children:"Combine multiple function calls:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:'extend type orders {\n  # First function: calculate base discount\n  base_discount: Float @function_call(\n    references_name: "calculate_base_discount"\n    args: { order_id: "id" }\n  )\n  \n  # Second function: apply loyalty bonus\n  final_discount: Float @function_call(\n    references_name: "apply_loyalty_bonus"\n    args: {\n      customer_id: "customer_id"\n      base_discount: "base_discount"\n    }\n  )\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,a.jsx)(e.h3,{id:"efficient-function-execution",children:"Efficient Function Execution"}),"\n",(0,a.jsx)(e.p,{children:"For best performance when calling functions for multiple rows:"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Use set-returning functions"}),": Create functions that return multiple rows at once"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Create parameterized views"}),": Define views with the function call that can be joined with the main table"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Leverage joins"}),": Use ",(0,a.jsx)(e.code,{children:"@join"})," with a view containing the function results"]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"Example with parameterized view:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:'type product_recommendations_view @view(\n  name: "product_recommendations"\n  sql: """\n    SELECT * FROM get_all_recommendations([$category_id])\n  """\n) @args(name: "recommendations_args") {\n  product_id: Int!\n  recommended_product_id: Int!\n  score: Float!\n}\n\ninput recommendations_args {\n  category_id: Int!\n}\n'})}),"\n",(0,a.jsx)(e.h3,{id:"limiting-function-executions",children:"Limiting Function Executions"}),"\n",(0,a.jsx)(e.p,{children:"Control function execution with filters:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-graphql",children:'query {\n  products(\n    filter: { status: { eq: "active" } }\n    limit: 10\n  ) {\n    id\n    # Function only called for filtered results\n    recommendations {\n      id\n      name\n    }\n  }\n}\n'})})]})}function u(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(d,{...n})}):d(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>c,x:()=>o});var t=i(6540);const a={},s=t.createContext(a);function c(n){const e=t.useContext(s);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:c(n.components),t.createElement(s.Provider,{value:e},n.children)}}}]);