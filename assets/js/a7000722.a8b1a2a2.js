"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[8816],{4873:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"graphql/queries/basic-queries","title":"Basic Queries","description":"Hugr automatically generates optimized query types for retrieving single records by primary keys and unique constraints. These queries provide the fastest way to fetch individual records when you know their identifying values.","source":"@site/docs/5-graphql/1-queries/2-basic-queries.md","sourceDirName":"5-graphql/1-queries","slug":"/graphql/queries/basic-queries","permalink":"/docs/graphql/queries/basic-queries","draft":false,"unlisted":false,"editUrl":"https://github.com/hugr-lab/hugr-lab.github.io/docs/5-graphql/1-queries/2-basic-queries.md","tags":[],"version":"current","lastUpdatedBy":"Claude","lastUpdatedAt":1762461702000,"sidebarPosition":2,"frontMatter":{"title":"Basic Queries","sidebar_position":2},"sidebar":"docsSidebar","previous":{"title":"Function Calls","permalink":"/docs/graphql/queries/function-calls"},"next":{"title":"Filtering","permalink":"/docs/graphql/queries/filtering"}}');var r=i(4848),l=i(8453);const a={title:"Basic Queries",sidebar_position:2},t="Basic Queries",d={},c=[{value:"Query by Primary Key",id:"query-by-primary-key",level:2},{value:"Composite Primary Keys",id:"composite-primary-keys",level:3},{value:"Non-Existent Records",id:"non-existent-records",level:3},{value:"Query by Unique Constraint",id:"query-by-unique-constraint",level:2},{value:"Multiple Field Unique Constraints",id:"multiple-field-unique-constraints",level:3},{value:"Multiple Unique Constraints",id:"multiple-unique-constraints",level:3},{value:"Fetching Related Data",id:"fetching-related-data",level:2},{value:"Selecting Nested Objects",id:"selecting-nested-objects",level:2},{value:"Using Variables",id:"using-variables",level:2},{value:"Parameterized Views",id:"parameterized-views",level:2},{value:"Soft Deleted Records",id:"soft-deleted-records",level:2},{value:"Fragments for Reusability",id:"fragments-for-reusability",level:2},{value:"Multiple Queries in One Request",id:"multiple-queries-in-one-request",level:2},{value:"Field Selection",id:"field-selection",level:2},{value:"Selecting Specific Fields",id:"selecting-specific-fields",level:3},{value:"Field Aliases",id:"field-aliases",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"1. Use Appropriate Indexes",id:"1-use-appropriate-indexes",level:3},{value:"2. Limit Related Data",id:"2-limit-related-data",level:3},{value:"3. Select Only Required Fields",id:"3-select-only-required-fields",level:3},{value:"4. Use Aggregations Instead",id:"4-use-aggregations-instead",level:3},{value:"Common Patterns",id:"common-patterns",level:2},{value:"Check if Record Exists",id:"check-if-record-exists",level:3},{value:"Get Record with Specific Relations",id:"get-record-with-specific-relations",level:3},{value:"Fetch Multiple Related Records",id:"fetch-multiple-related-records",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Next Steps",id:"next-steps",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"basic-queries",children:"Basic Queries"})}),"\n",(0,r.jsx)(n.p,{children:"Hugr automatically generates optimized query types for retrieving single records by primary keys and unique constraints. These queries provide the fastest way to fetch individual records when you know their identifying values."}),"\n",(0,r.jsx)(n.h2,{id:"query-by-primary-key",children:"Query by Primary Key"}),"\n",(0,r.jsxs)(n.p,{children:["For every data object with a ",(0,r.jsx)(n.code,{children:"@pk"})," directive, Hugr generates a ",(0,r.jsx)(n.code,{children:"<object>_by_pk"})," query that retrieves a single record:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query {\n  customers_by_pk(id: 123) {\n    id\n    name\n    email\n    phone\n    created_at\n  }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Response:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "customers_by_pk": {\n      "id": 123,\n      "name": "John Doe",\n      "email": "john@example.com",\n      "phone": "+1-555-0123",\n      "created_at": "2024-01-15T10:30:00Z"\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"composite-primary-keys",children:"Composite Primary Keys"}),"\n",(0,r.jsx)(n.p,{children:"For tables with multiple primary key fields, all key fields are required:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'# Schema definition\ntype order_details @table(name: "order_details") {\n  order_id: Int! @pk\n  product_id: Int! @pk\n  quantity: Int!\n  unit_price: Float!\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Query with composite key:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query {\n  order_details_by_pk(order_id: 100, product_id: 50) {\n    order_id\n    product_id\n    quantity\n    unit_price\n    total: amount  # Calculated field\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"non-existent-records",children:"Non-Existent Records"}),"\n",(0,r.jsxs)(n.p,{children:["If no record matches the primary key, the query returns ",(0,r.jsx)(n.code,{children:"null"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query {\n  customers_by_pk(id: 99999) {\n    id\n    name\n  }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Response:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "customers_by_pk": null\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"query-by-unique-constraint",children:"Query by Unique Constraint"}),"\n",(0,r.jsxs)(n.p,{children:["For each ",(0,r.jsx)(n.code,{children:"@unique"})," directive on a data object, Hugr generates a query named ",(0,r.jsx)(n.code,{children:"<object>_by_<field>"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'# Schema definition\ntype customers @table(name: "customers")\n  @unique(fields: ["email"]) {\n  id: Int! @pk\n  name: String!\n  email: String!\n  phone: String\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Query by unique email:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'query {\n  customers_by_email(email: "john@example.com") {\n    id\n    name\n    email\n    phone\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"multiple-field-unique-constraints",children:"Multiple Field Unique Constraints"}),"\n",(0,r.jsx)(n.p,{children:"For unique constraints on multiple fields:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'# Schema definition\ntype products @table(name: "products")\n  @unique(fields: ["sku", "supplier_id"], query_suffix: "sku_supplier") {\n  id: Int! @pk\n  sku: String!\n  supplier_id: Int!\n  name: String!\n  price: Float!\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Query by multiple unique fields:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'query {\n  products_by_sku_supplier(sku: "PROD-123", supplier_id: 5) {\n    id\n    name\n    price\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"multiple-unique-constraints",children:"Multiple Unique Constraints"}),"\n",(0,r.jsx)(n.p,{children:"A data object can have multiple unique constraints, each generating its own query:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'type users @table(name: "users")\n  @unique(fields: ["email"])\n  @unique(fields: ["username"]) {\n  id: Int! @pk\n  email: String!\n  username: String!\n  name: String!\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"This generates two queries:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'query {\n  # Query by email\n  user_by_email: users_by_email(email: "john@example.com") {\n    id\n    username\n    name\n  }\n\n  # Query by username\n  user_by_username: users_by_username(username: "johndoe") {\n    id\n    email\n    name\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"fetching-related-data",children:"Fetching Related Data"}),"\n",(0,r.jsx)(n.p,{children:"Primary key and unique constraint queries support selecting related data:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'query {\n  customers_by_pk(id: 123) {\n    id\n    name\n    email\n\n    # Related orders\n    orders(\n      filter: { status: { eq: "pending" } }\n      order_by: [{ field: "created_at", direction: DESC }]\n      limit: 5\n    ) {\n      id\n      status\n      total\n      created_at\n    }\n\n    # Aggregated order statistics\n    orders_aggregation {\n      _rows_count\n      total {\n        sum\n        avg\n      }\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"selecting-nested-objects",children:"Selecting Nested Objects"}),"\n",(0,r.jsx)(n.p,{children:"Include nested object fields and calculated fields:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'query {\n  customers_by_pk(id: 123) {\n    id\n    name\n    email\n\n    # Nested object field\n    address {\n      street\n      city\n      state\n      postal_code\n      country\n    }\n\n    # Calculated field\n    full_address\n\n    # Function call field\n    credit_score(as_of_date: "2024-03-01")\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"using-variables",children:"Using Variables"}),"\n",(0,r.jsx)(n.p,{children:"Use GraphQL variables for dynamic queries:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query GetCustomer($customerId: Int!) {\n  customers_by_pk(id: $customerId) {\n    id\n    name\n    email\n    created_at\n  }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Variables:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "customerId": 123\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"With unique constraints:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query GetCustomerByEmail($email: String!) {\n  customers_by_email(email: $email) {\n    id\n    name\n    phone\n  }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Variables:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "email": "john@example.com"\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"parameterized-views",children:"Parameterized Views"}),"\n",(0,r.jsxs)(n.p,{children:["For parameterized views (with ",(0,r.jsx)(n.code,{children:"@args"})," directive), pass required arguments:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'# Schema definition\ntype monthly_sales @view(\n  name: "monthly_sales_view"\n  sql: "SELECT * FROM get_monthly_sales([year], [month])"\n) @args(name: "monthly_sales_args", required: true) {\n  product_id: Int! @pk\n  product_name: String!\n  total_sales: Float!\n  units_sold: Int!\n}\n\ninput monthly_sales_args {\n  year: Int!\n  month: Int!\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Query with args:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query {\n  monthly_sales_by_pk(\n    product_id: 456\n    args: { year: 2024, month: 3 }\n  ) {\n    product_id\n    product_name\n    total_sales\n    units_sold\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"soft-deleted-records",children:"Soft Deleted Records"}),"\n",(0,r.jsx)(n.p,{children:"For tables with soft delete enabled, deleted records are excluded by default:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query {\n  customers_by_pk(id: 123) {\n    id\n    name\n    deleted_at  # Will be NULL if not deleted\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["To include soft deleted records, use the ",(0,r.jsx)(n.code,{children:"@with_deleted"})," directive:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query {\n  customers_by_pk(id: 123) @with_deleted {\n    id\n    name\n    deleted_at\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"fragments-for-reusability",children:"Fragments for Reusability"}),"\n",(0,r.jsx)(n.p,{children:"Use fragments to define reusable selection sets:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'fragment CustomerBasicInfo on customers {\n  id\n  name\n  email\n  phone\n}\n\nfragment CustomerWithOrders on customers {\n  ...CustomerBasicInfo\n  orders(limit: 5) {\n    id\n    total\n    status\n  }\n}\n\nquery {\n  customer1: customers_by_pk(id: 123) {\n    ...CustomerWithOrders\n  }\n\n  customer2: customers_by_email(email: "jane@example.com") {\n    ...CustomerBasicInfo\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"multiple-queries-in-one-request",children:"Multiple Queries in One Request"}),"\n",(0,r.jsx)(n.p,{children:"Fetch multiple records with aliases:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'query {\n  customer1: customers_by_pk(id: 123) {\n    id\n    name\n    email\n  }\n\n  customer2: customers_by_pk(id: 456) {\n    id\n    name\n    email\n  }\n\n  customer3: customers_by_email(email: "admin@example.com") {\n    id\n    name\n  }\n\n  product: products_by_pk(id: 789) {\n    id\n    name\n    price\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"field-selection",children:"Field Selection"}),"\n",(0,r.jsx)(n.h3,{id:"selecting-specific-fields",children:"Selecting Specific Fields"}),"\n",(0,r.jsx)(n.p,{children:"Always select only the fields you need:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"# Good - Select only needed fields\nquery {\n  customers_by_pk(id: 123) {\n    id\n    name\n    email\n  }\n}\n\n# Avoid - Selecting unnecessary fields\nquery {\n  customers_by_pk(id: 123) {\n    id\n    name\n    email\n    phone\n    fax\n    address\n    city\n    state\n    postal_code\n    country\n    region\n    created_at\n    updated_at\n    notes\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"field-aliases",children:"Field Aliases"}),"\n",(0,r.jsx)(n.p,{children:"Rename fields in the response:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query {\n  customers_by_pk(id: 123) {\n    customerId: id\n    customerName: name\n    emailAddress: email\n    registrationDate: created_at\n  }\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Response:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "customers_by_pk": {\n      "customerId": 123,\n      "customerName": "John Doe",\n      "emailAddress": "john@example.com",\n      "registrationDate": "2024-01-15T10:30:00Z"\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,r.jsx)(n.h3,{id:"1-use-appropriate-indexes",children:"1. Use Appropriate Indexes"}),"\n",(0,r.jsx)(n.p,{children:"Ensure indexes exist on:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Primary key fields (usually automatic)"}),"\n",(0,r.jsx)(n.li,{children:"Unique constraint fields"}),"\n",(0,r.jsx)(n.li,{children:"Foreign key fields when selecting relations"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-limit-related-data",children:"2. Limit Related Data"}),"\n",(0,r.jsxs)(n.p,{children:["When fetching relations, always use ",(0,r.jsx)(n.code,{children:"limit"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query {\n  customers_by_pk(id: 123) {\n    id\n    name\n    orders(limit: 10) {  # Limit to prevent large responses\n      id\n      total\n    }\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-select-only-required-fields",children:"3. Select Only Required Fields"}),"\n",(0,r.jsx)(n.p,{children:"Avoid selecting large fields unless necessary:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"# Avoid selecting large JSON or text fields\nquery {\n  customers_by_pk(id: 123) {\n    id\n    name\n    # Skip: large_metadata, detailed_notes, etc.\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-use-aggregations-instead",children:"4. Use Aggregations Instead"}),"\n",(0,r.jsx)(n.p,{children:"When you only need counts or statistics:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query {\n  customers_by_pk(id: 123) {\n    id\n    name\n    # Instead of: orders { id }\n    # Use aggregation:\n    orders_aggregation {\n      _rows_count\n    }\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"common-patterns",children:"Common Patterns"}),"\n",(0,r.jsx)(n.h3,{id:"check-if-record-exists",children:"Check if Record Exists"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query CheckExists($id: Int!) {\n  customers_by_pk(id: $id) {\n    id\n  }\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["If result is ",(0,r.jsx)(n.code,{children:"null"}),", record doesn't exist."]}),"\n",(0,r.jsx)(n.h3,{id:"get-record-with-specific-relations",children:"Get Record with Specific Relations"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:'query GetCustomerWithActiveOrders($id: Int!) {\n  customers_by_pk(id: $id) {\n    id\n    name\n    email\n    active_orders: orders(\n      filter: { status: { in: ["pending", "processing"] } }\n    ) {\n      id\n      status\n      total\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"fetch-multiple-related-records",children:"Fetch Multiple Related Records"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-graphql",children:"query GetOrderDetails($orderId: Int!) {\n  orders_by_pk(id: $orderId) {\n    id\n    status\n    total\n    customer {\n      id\n      name\n      email\n    }\n    items: order_details {\n      product {\n        id\n        name\n      }\n      quantity\n      unit_price\n    }\n    shipper {\n      name\n      phone\n    }\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.p,{children:"Handle cases where records might not exist:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"const query = `\n  query GetCustomer($id: Int!) {\n    customers_by_pk(id: $id) {\n      id\n      name\n      email\n    }\n  }\n`;\n\nconst result = await client.query(query, { id: 123 });\n\nif (result.data.customers_by_pk === null) {\n  console.error('Customer not found');\n} else {\n  console.log('Customer:', result.data.customers_by_pk);\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Learn about ",(0,r.jsx)(n.a,{href:"/docs/graphql/queries/filtering",children:"Filtering"})," for complex queries with multiple conditions"]}),"\n",(0,r.jsxs)(n.li,{children:["See ",(0,r.jsx)(n.a,{href:"/docs/graphql/queries/relations",children:"Relations"})," for working with related data"]}),"\n",(0,r.jsxs)(n.li,{children:["Check ",(0,r.jsx)(n.a,{href:"/docs/graphql/queries/aggregations",children:"Aggregations"})," for computing statistics"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>t});var s=i(6540);const r={},l=s.createContext(r);function a(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);